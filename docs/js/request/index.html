<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="HonjayChang Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="HonjayChang Blog Atom Feed"><title data-react-helmet="true">ç½‘ç»œè¯·æ±‚ | HonjayChang</title><meta data-react-helmet="true" property="og:url" content="https://honjaychang.github.io//docs/js/request"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ç½‘ç»œè¯·æ±‚ | HonjayChang"><meta data-react-helmet="true" name="description" content="Xhr &amp; Fetch"><meta data-react-helmet="true" property="og:description" content="Xhr &amp; Fetch"><link data-react-helmet="true" rel="shortcut icon" href="/img/photo.ico"><link data-react-helmet="true" rel="canonical" href="https://honjaychang.github.io//docs/js/request"><link data-react-helmet="true" rel="alternate" href="https://honjaychang.github.io//docs/js/request" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://honjaychang.github.io//docs/js/request" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.6b743985.css">
<link rel="preload" href="/assets/js/runtime~main.fde05104.js" as="script">
<link rel="preload" href="/assets/js/main.a852bf25.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://honjaychang.github.io/docs/home" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img src="/img/photo.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/photo.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/Home">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Honjaychang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Home">Home</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">HC</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">JS</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/js/basic">JS åŸºç¡€</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/js/advanced">JS è¿›é˜¶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/js/object">JS å¯¹è±¡</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/js/async">å¼‚æ­¥</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/js/dataStructure">JS æ•°æ®ç»“æ„</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/js/module">æ¨¡å—åŒ–</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/js/reg">æ­£åˆ™</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/js/request">ç½‘ç»œè¯·æ±‚</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/js/hand">JSå®ç°</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Extension</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">TS</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">React</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ReactCore</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Dev</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Algo</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Interview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Vue</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">ç½‘ç»œè¯·æ±‚</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="xhr--fetch"></a><code>Xhr &amp; Fetch</code><a class="hash-link" href="#xhr--fetch" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="xmlhttprequest"></a><code>XMLHttpRequest</code><a class="hash-link" href="#xmlhttprequest" title="Direct link to heading">#</a></h3><ul><li>é€šè¿‡<code>XMLHttpRequest</code>å‘æœåŠ¡å™¨å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œè·å¾—æœåŠ¡å™¨è¿”å›çš„æ•°æ®ï¼Œåˆ©ç”¨<code>js</code>æ›´æ–°é¡µé¢</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getå®ç°"></a>Getå®ç°<a class="hash-link" href="#getå®ç°" title="Direct link to heading">#</a></h4><ul><li>åˆ›å»º<code>XMLHttpRequest</code>å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºä¸€ä¸ªå¼‚æ­¥è°ƒç”¨å¯¹è±¡</li><li>åˆ›å»ºä¸€ä¸ªæ–°çš„ HTTP è¯·æ±‚ï¼Œå¹¶æŒ‡å®šè¯¥ HTTP è¯·æ±‚çš„æ–¹æ³•ã€URL åŠéªŒè¯ä¿¡æ¯</li><li>è®¾ç½®å“åº” HTTP è¯·æ±‚çŠ¶æ€å˜åŒ–çš„å‡½æ•°</li><li>å‘é€ HTTP è¯·æ±‚</li><li>è·å–å¼‚æ­¥è°ƒç”¨è¿”å›çš„æ•°æ®</li><li>ä½¿ç”¨<code>JavaScript</code>å’Œ<code>DOM</code>å®ç°å±€éƒ¨åˆ·æ–°</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// XMLHttpRequest get è¯·æ±‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> xhr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">XMLHttpRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">XMLHttpRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ActiveXObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Microsoft.XMLHTTP&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//å…¼å®¹ie5/6</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 0</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;GET&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;data.json&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// æ˜¯å¦å¼‚æ­¥ false // 1</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onreadystatechange</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">readyState</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 2 3 4</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">responseText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">responseText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;some error happened&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="postå®ç°"></a>Postå®ç°<a class="hash-link" href="#postå®ç°" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// XMLHttpRequest post è¯·æ±‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> xhr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">XMLHttpRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;POST&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/login&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// æ˜¯å¦å¼‚æ­¥ true --&gt; å¼‚æ­¥</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/* xhr.setRequestHeader(&#x27;Content-type&#x27;,&#x27;application/x-www-form-urlencoded&#x27;)</span></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * xhr.send(&#x27;status=1&amp;flag=1&#x27;)</span></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * POSTè¯·æ±‚æ–¹å¼å¿…é¡»è®¾ç½®è¿™ä¸ªè¯·æ±‚å¤´ä¿¡æ¯ï¼Œç›®çš„æ˜¯è¯·æ±‚ä½“ä¸­çš„æ•°æ®è½¬æ¢ä¸ºé”®å€¼å¯¹ï¼Œè¿™æ ·åç«¯æ¥æ”¶åˆ°status=1&amp;flag=1è¿™æ ·çš„æ•°æ®æ‰çŸ¥é“æ˜¯è¿™æ˜¯ä¸€ä¸ªPOSTæ–¹å¼ä¼ æ¥çš„æ•°æ®</span></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onreadystatechange</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">readyState</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">responseText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">responseText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;some error happened&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> postData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  username</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;zhangsan&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  password</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;xxx&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">postData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="çŠ¶æ€ç "></a>çŠ¶æ€ç <a class="hash-link" href="#çŠ¶æ€ç " title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="xhrreadystate"></a><code>xhr.readyState</code><a class="hash-link" href="#xhrreadystate" title="Direct link to heading">#</a></h5><ul><li>0 -ï¼ˆè¯·æ±‚æœªåˆå§‹åŒ–ï¼‰è¿˜æ²¡æœ‰è°ƒç”¨<code>send()</code>æ–¹æ³•</li><li>1 -ï¼ˆæœåŠ¡å™¨è¿æ¥å·²å»ºç«‹ï¼‰å·²è°ƒç”¨<code>send()</code>æ–¹æ³•ï¼Œæ­£åœ¨å‘é€è¯·æ±‚</li><li>2 -ï¼ˆè¯·æ±‚å·²æ¥æ”¶ï¼‰ <code>send()</code>æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œå·²ç»æ¥æ”¶åˆ°å…¨éƒ¨å“åº”å†…å®¹</li><li>3 -ï¼ˆè¯·æ±‚å¤„ç†ä¸­ï¼‰æ­£åœ¨è§£æå“åº”å†…å®¹</li><li>4 -ï¼ˆè¯·æ±‚å·²å®Œæˆï¼Œä¸”å“åº”å·²å°±ç»ªï¼‰å“åº”å†…å®¹è§£æå®Œæˆï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯è°ƒç”¨</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> xhr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">XMLHttpRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;UNSENT&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">readyState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// readyState ä¸º 0</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;GET&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/api&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;OPENED&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">readyState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// readyState ä¸º 1</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onprogress</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;LOADING&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">readyState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// readyState ä¸º 3</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onload</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;DONE&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">readyState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// readyState ä¸º 4</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="xhrstatus"></a><code>xhr.status</code><a class="hash-link" href="#xhrstatus" title="Direct link to heading">#</a></h5><ul><li>2xx - è¡¨ç¤ºæˆåŠŸå¤„ç†è¯·æ±‚ï¼Œå¦‚ 200</li><li>3xx - éœ€è¦é‡å®šå‘ï¼Œæµè§ˆå™¨ç›´æ¥è·³è½¬ï¼Œå¦‚ 301 302 304</li><li>4xx - å®¢æˆ·ç«¯è¯·æ±‚é”™è¯¯ï¼Œå¦‚ 404 403</li><li>5xx - æœåŠ¡å™¨ç«¯é”™è¯¯</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ajax"></a><code>AJAX</code><a class="hash-link" href="#ajax" title="Direct link to heading">#</a></h3><ul><li><code>Asynchronous Javascript and XML</code></li><li>å¼‚æ­¥<code>JavaScrpt</code>å’Œ<code>xml</code>ï¼Œç”¨äºåœ¨ Web é¡µé¢ä¸­å®ç°å¼‚æ­¥æ•°æ®äº¤äº’ï¼Œå®ç°é¡µé¢å±€éƒ¨åˆ·æ–°</li><li><code>ajax</code> åŸºäº <code>XMLHttpRequest</code>åˆ†åˆ«æ‰§è¡ŒæˆåŠŸå’Œå¤±è´¥çš„å›è°ƒã€‚</li></ul><p>ä¼˜ç‚¹ï¼š</p><ul><li>å¼‚æ­¥è¯·æ±‚å“åº”å¿«ï¼Œç”¨æˆ·ä½“éªŒå¥½ï¼ˆä½¿ç”¨å¼‚æ­¥çš„æ–¹å¼ä¸æœåŠ¡å™¨é€šä¿¡ï¼Œä¸æ‰“æ–­ç”¨æˆ·çš„æ“ä½œï¼‰</li><li>é¡µé¢æ— åˆ·æ–°ã€æ•°æ®å±€éƒ¨æ›´æ–°ï¼ˆåœ¨ä¸åˆ·æ–°æ•´ä¸ªé¡µé¢çš„æƒ…å†µä¸‹ç»´æŒä¸æœåŠ¡å™¨é€šä¿¡ï¼‰</li><li>æŒ‰éœ€å–æ•°æ®ï¼Œå‡å°‘äº†å†—ä½™è¯·æ±‚å’ŒæœåŠ¡å™¨çš„è´Ÿæ‹…ã€‚å‰ç«¯å’Œåç«¯è´Ÿè½½å‡è¡¡ï¼ˆå°†ä¸€äº›åç«¯çš„å·¥ä½œäº¤ç»™å‰ç«¯ï¼Œå‡å°‘æœåŠ¡å™¨ä¸å®½åº¦çš„è´Ÿæ‹…ï¼‰</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å¯¹æœç´¢å¼•æ“ä¸å‹å¥½</li><li><code>ajax</code>ä¸æ”¯æŒè¿”å›ä¸Šä¸€æ¬¡è¯·æ±‚å†…å®¹ ä¸æ”¯æŒæµè§ˆå™¨<code>back</code>æŒ‰é’®<ul><li><code>location.hash</code>æ¥è§£å†³<code>Ajax</code>è¿‡ç¨‹ä¸­å¯¼è‡´çš„æµè§ˆå™¨å‰è¿›åé€€æŒ‰é”®å¤±æ•ˆ</li></ul></li><li>å¯èƒ½é€ æˆè¯·æ±‚æ•°çš„å¢åŠ  è·¨åŸŸé—®é¢˜é™åˆ¶</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="axios"></a><code>axios</code><a class="hash-link" href="#axios" title="Direct link to heading">#</a></h3><ul><li><code>Axios</code> æ˜¯ä¸€ä¸ªåŸºäº <code>promise</code> çš„ <code>HTTP</code> åº“ï¼Œå¯ä»¥ç”¨åœ¨æµè§ˆå™¨å’Œ <code>node.js</code> ä¸­ã€‚å®ƒæœ¬è´¨ä¹Ÿæ˜¯å¯¹åŸç”Ÿ<code>XMLHttpRequest</code> çš„å°è£…ï¼Œåªä¸è¿‡å®ƒæ˜¯ <code>Promise</code> çš„å®ç°ç‰ˆæœ¬ï¼Œç¬¦åˆæœ€æ–°çš„ESè§„èŒƒã€‚</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="fetch"></a><code>Fetch</code><a class="hash-link" href="#fetch" title="Direct link to heading">#</a></h3><p><code>Fetch API</code>æä¾›äº†ä¸€ä¸ª <code>JavaScript</code> æ¥å£ï¼Œç”¨äºè®¿é—®å’Œæ“ä½œ<code>HTTP</code>ç®¡é“çš„éƒ¨åˆ†ï¼Œä¾‹å¦‚è¯·æ±‚å’Œå“åº”ã€‚å®ƒè¿˜æä¾›äº†ä¸€ä¸ªå…¨å±€<code>fetch()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æä¾›äº†ä¸€ç§ç®€å•ï¼Œåˆç†çš„æ–¹å¼æ¥è·¨ç½‘ç»œå¼‚æ­¥è·å–èµ„æºã€‚</p><p><code>fetch</code>æ˜¯ä½å±‚æ¬¡çš„APIï¼Œä»£æ›¿<code>XHR</code>ï¼Œå¯ä»¥è½»æ¾å¤„ç†å„ç§æ ¼å¼ï¼Œéæ–‡æœ¬åŒ–æ ¼å¼ã€‚å¯ä»¥å¾ˆå®¹æ˜“çš„è¢«å…¶ä»–æŠ€æœ¯ä½¿ç”¨ï¼Œä¾‹å¦‚<code>Service Workers</code>ã€‚ä½†æ˜¯æƒ³è¦å¾ˆå¥½çš„ä½¿ç”¨<code>fetch</code>ï¼Œéœ€è¦åšä¸€äº›å°è£…å¤„ç†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  method</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;POST&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  mode</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;no-cors&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// è·¨åŸŸ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  body</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// data can be `string` or {object}!</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  headers</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;Content-Type&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;application/json&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">res</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Error:&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><code>fetch</code> å‘é€è¯·æ±‚é»˜è®¤æ˜¯ä¸å¸¦ <code>cookie</code> çš„ï¼Œéœ€è¦è®¾ç½® <code>credentials</code><ul><li><code>omit</code>: é»˜è®¤å€¼ï¼Œå¿½ç•¥cookieçš„å‘é€</li><li><code>same-origin</code>: è¡¨ç¤ºcookieåªèƒ½åŒåŸŸå‘é€ï¼Œä¸èƒ½è·¨åŸŸå‘é€</li><li><code>include</code>: cookieæ—¢å¯ä»¥åŒåŸŸå‘é€ï¼Œä¹Ÿå¯ä»¥è·¨åŸŸå‘é€</li><li>è·¨åŸŸè®¾ç½®ä¸º <code>fetch(url, {credentials: &#x27;include&#x27;})</code></li></ul></li><li><code>fetch</code>åªå¯¹ç½‘ç»œè¯·æ±‚æŠ¥é”™ï¼Œå¯¹<code>400</code>ï¼Œ<code>500</code>éƒ½å½“åšæˆåŠŸçš„è¯·æ±‚ï¼Œéœ€è¦å°è£…å»å¤„ç†</li><li><code>fetch</code>ä¸æ”¯æŒ<code>abort</code>ï¼Œä¸æ”¯æŒè¶…æ—¶æ§åˆ¶ï¼Œä½¿ç”¨<code>setTimeout</code>åŠ<code>Promise.reject</code>çš„å®ç°è¶…æ—¶æ§åˆ¶å¹¶ä¸èƒ½é˜»æ­¢è¯·æ±‚è¿‡ç¨‹ç»§ç»­åœ¨åå°è¿è¡Œï¼Œé€ æˆäº†æµé‡çš„æµªè´¹</li><li><code>fetch</code>æ²¡æœ‰åŠæ³•åŸç”Ÿç›‘æµ‹è¯·æ±‚çš„è¿›åº¦ï¼Œè€Œ<code>XHR</code>å¯ä»¥</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è·¨åŸŸ"></a>è·¨åŸŸ<a class="hash-link" href="#è·¨åŸŸ" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åŒæºç­–ç•¥"></a>åŒæºç­–ç•¥<a class="hash-link" href="#åŒæºç­–ç•¥" title="Direct link to heading">#</a></h3><ul><li><code>ajax</code>è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨è¦æ±‚å½“å‰ç½‘é¡µå’Œ <code>server</code> å¿…é¡»åŒæºï¼ˆå®‰å…¨ï¼‰</li><li>åŒæºï¼šåè®®ã€åŸŸåã€ç«¯å£ï¼Œä¸‰è€…å¿…é¡»ä¸€è‡´<ul><li>å­åŸŸåä¹Ÿä¸åŒæº</li></ul></li></ul><p>å¦‚ä¸‹æ‰€ç¤ºå°±æ˜¯ä¸åŒæºï¼Œä¸”åè®®ã€åŸŸåã€ç«¯å£éƒ½ä¸åŒæº</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly basic"><pre tabindex="0" class="prism-code language-basic codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">å‰ç«¯ : http://a.com:8080/;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">server : https://b.com/api/xxx</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ä¸‰è€…éƒ½ä¸åŒæº: http VS https       a VS b      8080 VS 443</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">åŒæºç­–ç•¥ä»…é™äºæµè§ˆå™¨ åœ¨æµè§ˆå™¨ä¸­ç”Ÿæ•ˆ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">æœåŠ¡ç«¯å¹¶æ²¡æœ‰ï¼Œå¦‚ï¼šçˆ¬è™«ã€æ”»å‡»â€¦â€¦</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>åŠ è½½ <strong><code>å›¾ç‰‡ css js</code></strong> å¯æ— è§†åŒæºç­–ç•¥</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">img src</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">è·¨åŸŸçš„å›¾ç‰‡åœ°å€</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//ä½†æ˜¯å›¾ç‰‡å¯èƒ½å‡ºç°é˜²ç›—é“¾ è¿™æ˜¯ç”±æœåŠ¡å™¨ç«¯é™åˆ¶çš„</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">link href</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">è·¨åŸŸçš„cssåœ°å€</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script src</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">è·¨åŸŸçš„jsåœ°å€</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">img </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">å¯ç”¨äºç»Ÿè®¡æ‰“ç‚¹ï¼Œå¯ä½¿ç”¨ç¬¬ä¸‰æ–¹ç»Ÿè®¡æœåŠ¡</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">link</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">å¯ä½¿ç”¨</span><span class="token constant" style="color:#36acaa">CDN</span><span class="token plain">ï¼Œ </span><span class="token constant" style="color:#36acaa">CDN</span><span class="token plain"> ä¸€èˆ¬éƒ½æ˜¯å¤–åŸŸ</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">å¯å®ç° </span><span class="token constant" style="color:#36acaa">JSONP</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>è·¨åŸŸ<ul><li>æ‰€æœ‰çš„è·¨åŸŸè¯·æ±‚ï¼Œéƒ½å¿…é¡»ç»è¿‡ <code>server</code> ç«¯ å…è®¸å’Œé…åˆ</li><li>æœªç» <code>server</code> ç«¯å…è®¸å°±å®ç°è·¨åŸŸï¼Œè¯´æ˜æµè§ˆå™¨æœ‰æ¼æ´ï¼Œå±é™©ä¿¡å·</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è·¨åŸŸè§£å†³æ–¹æ¡ˆ"></a>è·¨åŸŸè§£å†³æ–¹æ¡ˆ<a class="hash-link" href="#è·¨åŸŸè§£å†³æ–¹æ¡ˆ" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åå‘ä»£ç†"></a>åå‘ä»£ç†<a class="hash-link" href="#åå‘ä»£ç†" title="Direct link to heading">#</a></h4><p><img src="https://cdn.jsdelivr.net/gh/honjaychang/bp/fe/20211010161857.webp" alt="img"></p><ul><li>åœ¨<code>vue</code>ä¸­ä½¿ç”¨<code>proxy</code>è¿›è¡Œè·¨åŸŸçš„åŸç†æ˜¯ï¼šå°†åŸŸåå‘é€ç»™æœ¬åœ°çš„æœåŠ¡å™¨ï¼ˆå¯åŠ¨ vue é¡¹ç›®çš„æœåŠ¡,<code>loclahost:8080</code>ï¼‰ï¼Œå†ç”±æœ¬åœ°çš„æœåŠ¡å™¨å»è¯·æ±‚çœŸæ­£çš„æœåŠ¡å™¨ã€‚</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">devServer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//é…ç½®è·¨åŸŸ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;/api&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            target</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;xxx.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// åå°æ¥å£åœ°å€</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            changOrigin</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å…è®¸è·¨åŸŸ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            pathRewrite</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// é‡å†™è·¯å¾„</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token string" style="color:#e3116c">&#x27;^/api&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// axios.defaults.baseURL = &#x27;/api&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p><code>setUpProxy.js</code>	<code>commonJs</code> ä»£ç </p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> proxy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;http-proxy-middleware&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">app</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// é‡è§/api1å‰ç¼€çš„è¯·æ±‚ å°±ä¼šè§¦å‘è¯¥ä»£ç†é…ç½®</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">proxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/api1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// è¯·æ±‚è½¬å‘ç»™è°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      target</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://localhost:5000&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      changeOrigin</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// æ§åˆ¶æœåŠ¡å™¨æ”¶åˆ°çš„å“åº”å¤´ä¸­Hostå­—æ®µçš„å€¼</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      pathRewrite</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;^/api1&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// é‡å†™è¯·æ±‚è·¯å¾„</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Ref</h5></div><div class="admonition-content"><ul><li><a href="https://juejin.cn/post/6844904033874886663" target="_blank" rel="noopener noreferrer">[VUE] vue é…ç½®åå‘ä»£ç†è§£å†³è·¨åŸŸ</a></li></ul></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="corsæœåŠ¡ç«¯æ”¯æŒ"></a><code>CORSï¼ˆæœåŠ¡ç«¯æ”¯æŒï¼‰</code><a class="hash-link" href="#corsæœåŠ¡ç«¯æ”¯æŒ" title="Direct link to heading">#</a></h4><ul><li><code>CORS(Cross-Origin Resourse Sharing)</code>ï¼Œè·¨åŸŸèµ„æºå…±äº«</li><li>ç›¸æ¯” <code>JSONP</code> åªèƒ½å‘<code>GET</code>è¯·æ±‚ï¼Œ<code>CORS</code> å…è®¸ä»»ä½•ç±»å‹çš„è¯·æ±‚</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// CORS  æœåŠ¡å™¨ç«¯è®¾ç½® http header</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ç¬¬äºŒä¸ªå‚æ•°å¡«å†™å…è®¸è·¨åŸŸçš„åŸŸåï¼Œä¸å»ºè®®ç›´æ¥å†™*</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setHeader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Access-Control-Allow-Origin&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://127.0.0.1:5500&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setHeader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Access-Control-Allow-Headers&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;X-Requested-With&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setHeader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;Access-Control-Allow-Methods&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;PUT,POST,GET,DELETE,OPTIONS&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// æ¥æ”¶è·¨åŸŸçš„cookie</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setHeader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Access-Control-Allow-Credentials&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;true&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç®€å•è¯·æ±‚"></a>ç®€å•è¯·æ±‚<a class="hash-link" href="#ç®€å•è¯·æ±‚" title="Direct link to heading">#</a></h5><p>å¯¹é‚£äº›å¯èƒ½å¯¹æœåŠ¡å™¨æ•°æ®äº§ç”Ÿå‰¯ä½œç”¨çš„ HTTP è¯·æ±‚æ–¹æ³•ï¼Œæµè§ˆå™¨å¿…é¡»é¦–å…ˆä½¿ç”¨ <code>OPTIONS</code> æ–¹æ³•å‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚ï¼Œä»è€Œè·çŸ¥æœåŠ¡ç«¯æ˜¯å¦å…è®¸è¯¥è·¨æºè¯·æ±‚ã€‚æœåŠ¡å™¨ç¡®è®¤å…è®¸ä¹‹åï¼Œæ‰å‘èµ·å®é™…çš„ HTTP è¯·æ±‚ã€‚åœ¨é¢„æ£€è¯·æ±‚çš„è¿”å›ä¸­ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿå¯ä»¥é€šçŸ¥å®¢æˆ·ç«¯ï¼Œæ˜¯å¦éœ€è¦æºå¸¦èº«ä»½å‡­è¯ å¦‚<code>cookie</code></p><blockquote><p>ç®€å•è¯·æ±‚ä¸ä¼šè§¦å‘CORSçš„é¢„æ£€è¯·æ±‚</p></blockquote><ul><li><p>è¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ä¹‹ä¸€ï¼š</p><ul><li>HEAD</li><li>GET</li><li>POST</li></ul></li><li><p>HTTPçš„å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µ</p><ul><li>Accept</li><li>Accept-Language</li><li>Content-Language</li><li>Last-Event-ID</li><li>Content-Typeï¼šåªé™äºä¸‰ä¸ªå€¼<ul><li><code>application/x-www-form-urlencoded</code></li><li><code>multipart/form-data</code></li><li><code>text/plain</code></li></ul></li></ul></li><li><p>å¯¹äºç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ç›´æ¥å‘å‡ºCORSè¯·æ±‚ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œå¢åŠ ä¸€ä¸ª<code>Origin</code>å­—æ®µã€‚ç”¨æ¥è¯´æ˜ï¼Œæœ¬æ¬¡è¯·æ±‚æ¥è‡ªå“ªä¸ªæºï¼ˆåè®® + åŸŸå + ç«¯å£ï¼‰</p></li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="éç®€å•è¯·æ±‚"></a>éç®€å•è¯·æ±‚<a class="hash-link" href="#éç®€å•è¯·æ±‚" title="Direct link to heading">#</a></h5><ul><li>éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯<code>PUT</code>æˆ–<code>DELETE</code>ï¼Œæˆ–è€…<code>Content-Type</code>å­—æ®µçš„ç±»å‹æ˜¯<code>application/json</code></li><li>ä¼šå…ˆå‘èµ·é¢„æ£€è¯·æ±‚ï¼Œåªæœ‰å½“å‰ç½‘é¡µæ‰€åœ¨çš„åŸŸååœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠåˆæ³•çš„è¯·æ±‚æ–¹æ³•å’Œå¤´éƒ¨ä¿¡æ¯ï¼Œæ‰ä¼šæ­£å¸¸å‘èµ·<code>XHR</code>è¯·æ±‚</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é¢„æ£€è¯·æ±‚"></a>é¢„æ£€è¯·æ±‚<a class="hash-link" href="#é¢„æ£€è¯·æ±‚" title="Direct link to heading">#</a></h5><ul><li>é¦–å…ˆä½¿ç”¨ <code>OPTIONS</code> æ–¹æ³•å‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œä»¥è·çŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸è¯¥å®é™…è¯·æ±‚</li><li>å¯ä»¥é¿å…è·¨åŸŸè¯·æ±‚å¯¹æœåŠ¡å™¨çš„ç”¨æˆ·æ•°æ®äº§ç”Ÿæœªé¢„æœŸçš„å½±å“ã€‚</li></ul><p>::: note Ref</p><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS" target="_blank" rel="noopener noreferrer">è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰</a></li><li><a href="https://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener noreferrer">è·¨åŸŸèµ„æºå…±äº« CORS è¯¦è§£</a></li></ul><p>:::</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="jsonp"></a><code>JSONP</code><a class="hash-link" href="#jsonp" title="Direct link to heading">#</a></h4><ul><li><code>JSON with Padding =&gt; &lt;script&gt;</code> <code>AJAX =&gt; XML</code></li><li><code>JSONP</code> ç¼ºç‚¹ï¼šåªé™äº<code>get</code>è¯·æ±‚ ä½†æ˜¯å…¼å®¹æ€§å¥½<ul><li>å› ä¸º<code>script</code> æ ‡ç­¾ä¸èƒ½è¿›è¡Œ<code>post</code>è¯·æ±‚</li></ul></li><li>å°è£…<code>jsonp</code>çš„æ ¸å¿ƒå°±åœ¨äºæˆ‘ä»¬ç›‘å¬<code>window</code>ä¸Šçš„<code>jsonp</code>è¿›è¡Œå›è°ƒæ—¶çš„åç§°</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script src</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;http://api.foo.com?callback=bar&#x27;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>å‘Šè¯‰æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯çš„å›è°ƒå‡½æ•°: <code>bar</code></li><li>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œæ‹¼æ¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°† <code>JSON</code> æ•°æ®æ”¾åœ¨å‡½æ•°åé‡Œé¢ï¼Œä½œä¸ºå­—ç¬¦ä¸²è¿”å›<code>bar({...})</code></li><li>å®¢æˆ·ç«¯ä¼šå°†æœåŠ¡å™¨è¿”å›çš„å­—ç¬¦ä¸²ï¼Œä½œä¸ºä»£ç è§£æï¼Œå› ä¸ºæµè§ˆå™¨è®¤ä¸ºï¼Œè¿™æ˜¯<code>&lt;script&gt;</code>æ ‡ç­¾è¯·æ±‚çš„è„šæœ¬å†…å®¹ã€‚è¿™æ—¶ï¼Œå®¢æˆ·ç«¯åªè¦å®šä¹‰äº†<code>bar()</code>å‡½æ•°ï¼Œå°±èƒ½åœ¨è¯¥å‡½æ•°ä½“å†…ï¼Œæ‹¿åˆ°æœåŠ¡å™¨è¿”å›çš„ <code>JSON</code> æ•°æ®ã€‚</li></ul><p>ä¸‹é¢ä»£ç é€šè¿‡åŠ¨æ€æ·»åŠ <code>&lt;script&gt;</code>å…ƒç´ ï¼Œå‘æœåŠ¡å™¨<code>example.com</code>å‘å‡ºè¯·æ±‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addScriptTag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">src</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> script </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;script&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setAttribute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;type&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;text/javascript&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">appendChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onload</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">addScriptTag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;http://example.com/ip?callback=foo&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Your public IP address is: &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ip</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><code>jQuery</code> å®ç°<code>jsonp</code></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  $</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">ajax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://127.0.0.1:5500/JS/jsonp.js&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  dataType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;jsonp&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  jsonpCallback</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;callback&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">success</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="websocket"></a><code>WebSocket</code><a class="hash-link" href="#websocket" title="Direct link to heading">#</a></h4><ul><li><code>websocket</code> æ˜¯ HTML5 çš„ä¸€ä¸ªæ–°åè®®ï¼Œå®ƒå…è®¸æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯ä¼ é€’ä¿¡æ¯ï¼Œå®ç°æµè§ˆå™¨å’Œå®¢æˆ·ç«¯åŒå·¥é€šä¿¡ã€‚</li><li>ä½¿ç”¨<code>ws://</code>å’Œ<code>wss://</code>ï¼ˆåŠ å¯†ï¼‰ä½œä¸ºåè®®å‰ç¼€ è¯¥åè®®ä¸å®è¡ŒåŒæºæ”¿ç­–ï¼Œåªè¦æœåŠ¡å™¨æ”¯æŒï¼Œå°±å¯ä»¥é€šè¿‡å®ƒè¿›è¡Œè·¨æºé€šä¿¡</li><li><code>websocket</code> å¼¥è¡¥äº† HTTP ä¸æ”¯æŒé•¿è¿æ¥çš„ç‰¹ç‚¹</li></ul><p>å…³äº<code>webSocket</code></p><ul><li><code>HTTP</code> é€šä¿¡åªèƒ½ç”±å®¢æˆ·ç«¯å‘èµ· å¦‚æœæœåŠ¡å™¨æœ‰è¿ç»­çš„çŠ¶æ€å˜åŒ–ï¼Œå®¢æˆ·ç«¯åªèƒ½ä½¿ç”¨â€œè½®è¯¢â€çš„æ–¹æ³•è·å–æ–°çš„ä¿¡æ¯ æ•ˆç‡å¾ˆä½ æµªè´¹èµ„æºï¼ˆä¸åœè¿æ¥ æˆ– è¿æ¥å§‹ç»ˆæ‰“å¼€</li><li><code>WebSocket</code> æœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ws </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">WebSocket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;wss://echo.websocket.org&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ws</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onopen</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">evt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Connection open ...&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ws</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Hello WebSockets!&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ws</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onmessage</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">evt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Received Message: &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> evt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ws</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ws</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onclose</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">evt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Connection closed.&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ws</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onerror</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">evt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ws</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;error&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><code>webSocket.readyState</code> è¿”å›å®ä¾‹å¯¹è±¡çš„å½“å‰çŠ¶æ€<ul><li><code>CONNECTING</code>ï¼šå€¼ä¸º 0ï¼Œè¡¨ç¤ºæ­£åœ¨è¿æ¥</li><li><code>OPEN</code>ï¼šå€¼ä¸º 1ï¼Œè¡¨ç¤ºè¿æ¥æˆåŠŸï¼Œå¯ä»¥é€šä¿¡äº†</li><li><code>CLOSING</code>ï¼šå€¼ä¸º 2ï¼Œè¡¨ç¤ºè¿æ¥æ­£åœ¨å…³é—­</li><li><code>CLOSED</code>ï¼šå€¼ä¸º 3ï¼Œè¡¨ç¤ºè¿æ¥å·²ç»å…³é—­ï¼Œæˆ–è€…æ‰“å¼€è¿æ¥å¤±è´¥</li></ul></li></ul><p>å¿ƒè·³æœºåˆ¶</p><ul><li>æ¯éš”ä¸€æ®µæ—¶é—´ä¼šå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå‘Šè¯‰æœåŠ¡å™¨è‡ªå·±è¿˜æ´»ç€ï¼ŒåŒæ—¶å®¢æˆ·ç«¯ä¼šç¡®è®¤æœåŠ¡å™¨ç«¯æ˜¯å¦è¿˜æ´»ç€ï¼Œå¦‚æœè¿˜æ´»ç€çš„è¯ï¼Œå°±ä¼šå›ä¼ ä¸€ä¸ªæ•°æ®åŒ…ç»™å®¢æˆ·ç«¯æ¥ç¡®å®šæœåŠ¡å™¨ç«¯ä¹Ÿè¿˜æ´»ç€ï¼Œå¦åˆ™çš„è¯ï¼Œæœ‰å¯èƒ½æ˜¯ç½‘ç»œæ–­å¼€è¿æ¥äº†ï¼Œéœ€è¦é‡è¿ã€‚</li></ul><p>å®ç°æ€è·¯</p><ul><li>æ¯éš”ä¸€æ®µå›ºå®šçš„æ—¶é—´ï¼Œå‘æœåŠ¡å™¨ç«¯å‘é€ä¸€ä¸ª <code>ping</code> æ•°æ®ï¼Œå¦‚æœåœ¨æ­£å¸¸çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ª <code>pong</code> ç»™å®¢æˆ·ç«¯ï¼Œå¦‚æœå®¢æˆ·ç«¯é€šè¿‡ <code>onmessage</code> äº‹ä»¶èƒ½ç›‘å¬åˆ°çš„è¯ï¼Œè¯´æ˜è¯·æ±‚æ­£å¸¸ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ¯éš” 3 ç§’çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ˜¯ç½‘ç»œæ–­å¼€çš„æƒ…å†µä¸‹ï¼Œåœ¨æŒ‡å®šçš„æ—¶é—´å†…æœåŠ¡å™¨ç«¯å¹¶æ²¡æœ‰è¿”å›å¿ƒè·³å“åº”æ¶ˆæ¯ï¼Œå› æ­¤æœåŠ¡å™¨ç«¯æ–­å¼€äº†ï¼Œå› æ­¤è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä½¿ç”¨ <code>ws.close</code> å…³é—­è¿æ¥ï¼Œåœ¨ä¸€æ®µæ—¶é—´åå¯ä»¥é€šè¿‡ <code>onclose</code> äº‹ä»¶ç›‘å¬åˆ°ã€‚å› æ­¤åœ¨ <code>onclose</code> äº‹ä»¶å†…ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ <code>reconnect</code> äº‹ä»¶è¿›è¡Œé‡è¿æ“ä½œã€‚</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="windowpostmessage"></a><code>window.postMessage</code><a class="hash-link" href="#windowpostmessage" title="Direct link to heading">#</a></h4><ul><li><code>window.postMessage(data, origin, source)</code></li><li>é…åˆ<code>iframe</code></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// index</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//è·å–iframeå…ƒç´ </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">iFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;myframe&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//iframeåŠ è½½å®Œæ¯•åå†å‘é€æ¶ˆæ¯ï¼Œå¦åˆ™å­é¡µé¢æ¥æ”¶ä¸åˆ°message</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">iFrame</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onload</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//iframeåŠ è½½å®Œç«‹å³å‘é€ä¸€æ¡æ¶ˆæ¯</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  iFrame</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">contentWindow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">postMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;MessageFromIndex1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;*&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// iframePage</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//å›è°ƒå‡½æ•°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">receiveMessageFromIndex</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token parameter">event</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;receiveMessageFromIndex&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//ç›‘å¬messageäº‹ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;message&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> receiveMessageFromIndex</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>çˆ¶çª—å£ç»™å­çª—å£å‘é€æ¶ˆæ¯çš„æ–¹å¼ï¼š <code>iFrame.contentWindow.postMessage(&#x27;MessageFromIndex1&#x27;,&#x27;*&#x27;)</code>å…¶å®å°±æ˜¯åœ¨çˆ¶çª—å£ä¸­æ“ä½œå­çª—å£å‘æ¶ˆæ¯ï¼Œç„¶åè®©å­çª—å£æ¥æ”¶è‡ªå·±åˆšæ‰å‘çš„æ¶ˆæ¯ã€‚ </li><li>å­çª—å£ç»™çˆ¶çª—å£å‘é€æ¶ˆæ¯çš„æ–¹å¼ï¼š<code>parent.postMessage( {msg: &#x27;MessageFromIframePage&#x27;}, &#x27;*&#x27;)</code>æ³¨æ„ï¼šæ­¤å¤„<code>parent === window.parent</code>ï¼Œå³å­çª—å£çš„çˆ¶çª—å£ å…¶å®å°±æ˜¯åœ¨å­çª—å£ä¸­æ“ä½œçˆ¶çª—å£å‘æ¶ˆæ¯ï¼Œç„¶åè®©çˆ¶çª—å£æ¥æ”¶è‡ªå·±åˆšæ‰å‘çš„æ¶ˆæ¯ã€‚ </li><li>æ€»ç»“ï¼šæ‰€è°“çš„è·¨çª—å£å‘é€æ¶ˆæ¯ï¼Œå°±æ˜¯é€šè¿‡åœ¨åˆ«çš„çª—å£æ“ä½œæœ¬çª—å£å‘é€æ¶ˆæ¯ï¼Œç„¶åæœ¬çª—å£å†è‡ªå·±æ¥æ”¶çš„æ–¹å¼å®ç°ã€‚</li></ul><p>::: note Ref</p><ul><li><a href="https://juejin.cn/post/6844903477018116104" target="_blank" rel="noopener noreferrer">ä½¿ç”¨ postMessage è§£å†³ iframe è·¨åŸŸé€šä¿¡é—®é¢˜</a></li></ul><p>:::</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç™»é™†éªŒè¯"></a>ç™»é™†éªŒè¯<a class="hash-link" href="#ç™»é™†éªŒè¯" title="Direct link to heading">#</a></h2><p><code>cookie</code> æ˜¯å­˜å‚¨åœ¨æµè§ˆå™¨çš„å°æ®µæ–‡æœ¬ï¼Œä¼šåœ¨æµè§ˆå™¨æ¯æ¬¡å‘åŒä¸€æœåŠ¡å™¨å†å‘èµ·è¯·æ±‚æ—¶è¢«æºå¸¦å¹¶å‘é€åˆ°æœåŠ¡ å™¨ä¸Šã€‚æˆ‘ä»¬å¯ä»¥æŠŠçŠ¶æ€ä¿¡æ¯æ”¾åœ¨<code>cookie</code>é‡Œï¼Œå¸¦ç»™æœåŠ¡å™¨ã€‚</p><p><code>session</code> æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨çš„ç”¨æˆ·æ•°æ®ã€‚æµè§ˆå™¨ç¬¬ä¸€æ¬¡å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šä¸ºå½“å‰ä¼šè¯åˆ›å»ºä¸€ä¸ª <code>session</code>ï¼Œå¹¶ä¸”æŠŠå¯¹åº”çš„ <code>session-id</code> å†™å…¥ <code>cookie</code> ä¸­ï¼Œç”¨æ¥æ ‡è¯† <code>session</code>ã€‚æ­¤åï¼Œæ¯æ¬¡ç”¨æˆ·çš„è¯·æ±‚éƒ½ä¼šæºå¸¦ ä¸€ä¸ªåŒ…å«äº† <code>session-id</code> çš„ <code>cookie</code>ï¼ŒæœåŠ¡å™¨è§£æå‡ºäº† <code>session-id</code>ï¼Œä¾¿èƒ½å®šä½åˆ°ç”¨æˆ·çš„ç”¨æˆ·ä¿¡æ¯ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‰ç«¯ç™»é™†é‰´æƒ"></a>å‰ç«¯ç™»é™†é‰´æƒ<a class="hash-link" href="#å‰ç«¯ç™»é™†é‰´æƒ" title="Direct link to heading">#</a></h2><ul><li><a href="https://juejin.cn/post/6845166891393089544" target="_blank" rel="noopener noreferrer">å‰ç«¯ç™»å½•</a></li><li><a href="https://juejin.cn/post/6898630134530752520" target="_blank" rel="noopener noreferrer">å‰ç«¯é‰´æƒï¼šcookieã€sessionã€tokenã€jwtã€å•ç‚¹ç™»å½•</a></li><li><a href="https://mp.weixin.qq.com/s/rBzDQBL0FgnvwpWrCSSJmw" target="_blank" rel="noopener noreferrer">ã€ç¬¬2397æœŸã€‘å…³äºé‰´æƒï¼Œçœ‹æ‡‚è¿™ç¯‡å°±å¤Ÿäº†</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®‰å…¨"></a>å®‰å…¨<a class="hash-link" href="#å®‰å…¨" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="xss-è·¨ç«™è„šæœ¬æ”»å‡»"></a><code>XSS</code> è·¨ç«™è„šæœ¬æ”»å‡»<a class="hash-link" href="#xss-è·¨ç«™è„šæœ¬æ”»å‡»" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ”»å‡»"></a>æ”»å‡»<a class="hash-link" href="#æ”»å‡»" title="Direct link to heading">#</a></h4><blockquote><p>åå°„å‹<code>XSS</code></p></blockquote><ul><li>åå°„å‹<code>XSS</code>ï¼ŒéæŒä¹…åŒ–ï¼Œéœ€è¦æ¬ºéª—ç”¨æˆ·è‡ªå·±å»ç‚¹å‡»é“¾æ¥æ‰èƒ½è§¦å‘<code>XSS</code>ä»£ç ï¼ˆæœåŠ¡å™¨ä¸­æ²¡æœ‰è¿™æ ·çš„é¡µé¢å’Œå†…å®¹ï¼‰ï¼Œä¸€èˆ¬å®¹æ˜“å‡ºç°åœ¨æœç´¢é¡µé¢ã€‚</li></ul><blockquote><p>å­˜å‚¨å‹<code>XSS</code></p></blockquote><p>ä¸€ä¸ªåšå®¢ç½‘ç«™ï¼Œæˆ‘å‘è¡¨ä¸€ç¯‡åšå®¢ï¼Œå…¶ä¸­åµŒå…¥<code>&lt;script&gt;</code>è„šæœ¬ï¼Œè„šæœ¬å†…å®¹ï¼šè·å–<code>cookie</code>ï¼Œå‘é€åˆ°æˆ‘çš„æœåŠ¡å™¨ï¼ˆæœåŠ¡å™¨é…åˆè·¨åŸŸï¼‰ã€‚å‘å¸ƒè¿™ç¯‡åšå®¢ï¼Œæœ‰äººæŸ¥çœ‹å®ƒï¼Œæˆ‘è½»æ¾æ”¶å‰²è®¿é—®è€…çš„<code>cookie</code>ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é¢„é˜²"></a>é¢„é˜²<a class="hash-link" href="#é¢„é˜²" title="Direct link to heading">#</a></h4><blockquote><p>è½¬è¯‘å­—ç¬¦</p></blockquote><ul><li>å‰ç«¯è¦æ›¿æ¢ï¼Œåç«¯ä¹Ÿè¦æ›¿æ¢ï¼Œéƒ½åšæ€»ä¸ä¼šæœ‰é”™</li><li><code>https://www.npmjs.com/package/xss</code></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">escape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">&amp;</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;amp;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">&lt;</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;lt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">&gt;</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">&quot;</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;quto;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">&#x27;</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;#39;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">`</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;#96;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">\/</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;#x2F;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p><code>HttpOnly</code></p></blockquote><ul><li>ç¦æ­¢é€šè¿‡<code>document.cookie</code>çš„æ–¹å¼è·å–<code>cookies</code></li></ul><blockquote><p>è®¾ç½®ç™½åå•æˆ–è€…é»‘åå•</p></blockquote><ul><li>å¯¹äºå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ å»ºè®®ä½¿ç”¨ ç™½åå•</li></ul><blockquote><p><code>csp</code></p></blockquote><ul><li><code>Content Security Policy</code> å†…å®¹å®‰å…¨ç­–ç•¥</li><li>å®è´¨ï¼šç™½åå•åˆ¶åº¦ï¼Œå¼€å‘è€…æ˜ç¡®å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå“ªäº›å¤–éƒ¨èµ„æºå¯ä»¥åŠ è½½å’Œæ‰§è¡Œ</li></ul><p>å¦‚ä½•å¯ç”¨<code>CSP</code></p><ul><li>é€šè¿‡ HTTP å¤´ä¿¡æ¯çš„<code>Content-Security-Policy</code>çš„å­—æ®µ</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">Content</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Security</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Policy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> script</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">src </span><span class="token string" style="color:#e3116c">&#x27;self&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> object</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">src </span><span class="token string" style="color:#e3116c">&#x27;none&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">style</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">src cdn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">example</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">org</span><span class="token plain"> third</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">party</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">org</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> child</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">src https</span><span class="token operator" style="color:#393A34">:</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>é€šè¿‡ç½‘é¡µçš„<code>&lt;meta&gt;</code>æ ‡ç­¾</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">meta http</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">equiv</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Content-Security-Policy&quot;</span><span class="token plain"> content</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;script-src &#x27;self&#x27;; object-src &#x27;none&#x27;; style-src cdn.example.org third-party.org; child-src https:&quot;</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>å¦‚ä¸Šè®¾ç½®<ul><li>è„šæœ¬ï¼šåªä¿¡ä»»å½“å‰åŸŸå</li><li><code>&lt;object&gt;</code>æ ‡ç­¾ï¼šä¸ä¿¡ä»»ä»»ä½• URLï¼Œå³ä¸åŠ è½½ä»»ä½•èµ„æº</li><li>æ ·å¼è¡¨ï¼šåªä¿¡ä»»<code>cdn.example.org</code>å’Œ<code>third-party.org</code></li><li>æ¡†æ¶ <code>(frame)</code>ï¼šå¿…é¡»ä½¿ç”¨<code>HTTPS</code>åè®®åŠ è½½</li><li>å…¶ä»–èµ„æºï¼šæ²¡æœ‰é™åˆ¶</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="csrf-è·¨ç«™è¯·æ±‚ä¼ªé€ "></a><code>CSRF</code> è·¨ç«™è¯·æ±‚ä¼ªé€ <a class="hash-link" href="#csrf-è·¨ç«™è¯·æ±‚ä¼ªé€ " title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ”»å‡»-1"></a>æ”»å‡»<a class="hash-link" href="#æ”»å‡»-1" title="Direct link to heading">#</a></h4><p>åŸç†ï¼š è¯±å¯¼ç”¨æˆ·æ‰“å¼€é»‘å®¢çš„ç½‘ç«™ï¼Œåœ¨é»‘å®¢çš„ç½‘ç«™ä¸­ï¼Œåˆ©ç”¨ç”¨æˆ·ç™»å½•çŠ¶æ€å‘èµ·è·¨ç«™ç‚¹è¯·æ±‚ã€‚</p><ol><li>æµè§ˆå™¨å‘ç½‘ç«™ A å‘èµ·é€šä¿¡è¯·æ±‚</li><li>ç½‘ç«™ A éªŒè¯é€šè¿‡ï¼Œå»ºç«‹äº†é€šä¿¡è¿æ¥ï¼Œåœ¨æµè§ˆå™¨å­˜äº† A çš„ cookie</li><li>æµè§ˆå™¨åœ¨æœªå…³é—­ A çš„è¿æ¥ä¸‹è®¿é—®ç½‘ç«™ B</li><li>ç½‘ç«™ B å«æœ‰æ¶æ„è¯·æ±‚ä»£ç ï¼Œå‘ç½‘ç«™ A å‘èµ·è¯·æ±‚</li><li>æµè§ˆå™¨æ ¹æ® B å‘èµ·çš„è¯·æ±‚å¹¶ä¸”æºå¸¦ A çš„ cookie è®¿é—® A</li><li>ç½‘ç«™ A éªŒè¯ cookie å¹¶ä¸”å“åº”äº†è¿™ä¸ªè¯·æ±‚</li></ol><p>ç½‘ç«™ B å°±é€šè¿‡ç›—ç”¨ä¿å­˜åœ¨å®¢æˆ·ç«¯çš„ cookieï¼Œä»¥å®¢æˆ·ç«¯çš„èº«ä»½æ¥è®¿é—®ç½‘ç«™ Aï¼Œä»¥å®¢æˆ·ç«¯èº«ä»½è¿›è¡Œä¸€äº›éæ³•æ“ä½œã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">ä½ æ­£åœ¨è´­ç‰©ï¼Œçœ‹ä¸­äº†æŸä¸ªå•†å“ï¼Œå•†å“idæ˜¯</span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ä»˜è´¹æ¥å£æ˜¯xxx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">pay</span><span class="token operator" style="color:#393A34">?</span><span class="token plain">id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token plain">ï¼Œä½†æ²¡æœ‰ä»»ä½•éªŒè¯</span></span><span class="token-line" style="color:#393A34"><span class="token plain">æˆ‘æ˜¯æ”»å‡»è€…ï¼Œæˆ‘çœ‹ä¸­äº†ä¸€ä¸ªå•†å“ï¼Œidæ˜¯</span><span class="token number" style="color:#36acaa">200</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">æˆ‘å‘ä½ å‘é€ä¸€å°ç”µå­é‚®ä»¶ï¼Œé‚®ä»¶æ ‡é¢˜å¾ˆå¸å¼•äºº</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ä½†é‚®ä»¶æ­£æ–‡éšè—ç€</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">img src</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">xxx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">pay</span><span class="token operator" style="color:#393A34">?</span><span class="token plain">id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">200</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ä½ ä¸€æŸ¥çœ‹é‚®ä»¶ï¼Œå°±å¸®æˆ‘è´­ä¹°äº†idæ˜¯</span><span class="token number" style="color:#36acaa">200</span><span class="token plain">çš„å•†å“</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é¢„é˜²-1"></a>é¢„é˜²<a class="hash-link" href="#é¢„é˜²-1" title="Direct link to heading">#</a></h4><blockquote><p><code>SameSite</code></p></blockquote><ul><li><p>å¯¹ <code>Cookie</code> è®¾ç½® <code>SameSite</code> å±æ€§ã€‚è¡¨ç¤º <code>Cookie</code> ä¸éšç€è·¨åŸŸè¯·æ±‚å‘é€ï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦å‡å°‘ <code>CSRF</code> çš„æ”»å‡»ï¼Œä½†æ˜¯å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚</p><ul><li><p><code>Strict</code>ï¼šæ‰€æœ‰ä»å½“å‰åŸŸå‘é€å‡ºæ¥çš„éåŒåŸŸè¯·æ±‚éƒ½ä¸ä¼šå¸¦ä¸Š<code>cookie</code></p></li><li><p><code>Lax</code>ï¼šå°±æ˜¯åœ¨ GET æ–¹å¼æäº¤è¡¨å•æ—¶ä¼šæºå¸¦<code>cookieï¼Œpostã€iframe/img</code>ç­‰æ ‡ç­¾åŠ è½½æ—¶ä¸ä¼šæºå¸¦<code>cookie</code>ã€‚</p></li><li><p><code>None</code>ï¼šå…³é—­<code>SameSite</code>ï¼Œä¸è¿‡ï¼Œå‰ææ˜¯å¿…é¡»åŒæ—¶è®¾ç½®<code>Secure</code>å±æ€§<code>(Cookie åªèƒ½é€šè¿‡ HTTPS åè®®å‘é€)</code>ï¼Œå¦åˆ™æ— æ•ˆã€‚</p></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token known-class-name class-name">Set</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Cookie</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">CookieName</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">CookieValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token maybe-class-name">SameSite</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">Strict</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//è¿™ä¸ªè§„åˆ™è¿‡äºä¸¥æ ¼ï¼Œå¯èƒ½é€ æˆéå¸¸ä¸å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//æ¯”å¦‚ï¼Œå½“å‰ç½‘é¡µæœ‰ä¸€ä¸ª GitHub é“¾æ¥ï¼Œç”¨æˆ·ç‚¹å‡»è·³è½¬å°±ä¸ä¼šå¸¦æœ‰ GitHub çš„ Cookieï¼Œè·³è½¬è¿‡å»æ€»æ˜¯æœªç™»é™†çŠ¶æ€ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token known-class-name class-name">Set</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Cookie</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">CookieName</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">CookieValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token maybe-class-name">SameSite</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">Lax</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//Laxè§„åˆ™ç¨ç¨æ”¾å®½ï¼Œå¤§å¤šæ•°æƒ…å†µä¹Ÿæ˜¯ä¸å‘é€ç¬¬ä¸‰æ–¹ Cookieï¼Œä½†æ˜¯å¯¼èˆªåˆ°ç›®æ ‡ç½‘å€çš„ Get è¯·æ±‚é™¤å¤–ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token known-class-name class-name">Set</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Cookie</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> widget_session</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">abc123</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token maybe-class-name">SameSite</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">None</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token maybe-class-name">Secure</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>éªŒè¯ <code>HTTP Referer</code> å­—æ®µ</p></blockquote><ul><li><code>HTTP Referer</code>æ˜¯<code>header</code>çš„ä¸€éƒ¨åˆ†ï¼Œå½“æµè§ˆå™¨å‘ web æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œä¸€èˆ¬ä¼šå¸¦ä¸Š<code>Referer</code>ä¿¡æ¯å‘Šè¯‰æœåŠ¡å™¨æ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼ŒæœåŠ¡å™¨ç±æ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†ã€‚å¯ä»¥é€šè¿‡æ£€æŸ¥è¯·æ±‚çš„æ¥æºæ¥é˜²å¾¡<code>CSRF</code>æ”»å‡»ã€‚æ­£å¸¸è¯·æ±‚çš„<code>referer</code>å…·æœ‰ä¸€å®šè§„å¾‹ï¼Œå¦‚åœ¨æäº¤è¡¨å•çš„<code>referer</code>å¿…å®šæ˜¯åœ¨è¯¥é¡µé¢å‘èµ·çš„è¯·æ±‚ã€‚æ‰€ä»¥é€šè¿‡æ£€æŸ¥<code>http</code>åŒ…å¤´<code>referer</code>çš„å€¼æ˜¯ä¸æ˜¯è¿™ä¸ªé¡µé¢ï¼Œæ¥åˆ¤æ–­æ˜¯ä¸æ˜¯<code>CSRF</code>æ”»å‡»ã€‚</li><li><code>Refer</code> å¯èƒ½è¢«ä¼ªé€ </li></ul><blockquote><p>åœ¨è¯·æ±‚åœ°å€ä¸­æ·»åŠ  <code>token</code> å¹¶éªŒè¯</p></blockquote><ul><li><p><code>token</code> è¯·æ±‚æ‹¦æˆª éªŒè¯æ˜¯å¦åˆæ³•</p></li><li><p>ä½¿ç”¨ <code>post</code> æ¥å£</p></li><li><p>å¢åŠ éªŒè¯ï¼Œä¾‹å¦‚å¯†ç ã€çŸ­ä¿¡éªŒè¯ç ã€æŒ‡çº¹ç­‰</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sql-æ³¨å…¥"></a><code>sql</code> æ³¨å…¥<a class="hash-link" href="#sql-æ³¨å…¥" title="Direct link to heading">#</a></h3><blockquote><p>æƒé™æœ€å°åŒ–</p></blockquote><ul><li>ä¸¥æ ¼é™åˆ¶ Web åº”ç”¨çš„æ•°æ®åº“çš„æ“ä½œæƒé™ï¼Œç»™æ­¤ç”¨æˆ·æä¾›ä»…ä»…èƒ½å¤Ÿæ»¡è¶³å…¶å·¥ä½œçš„æœ€ä½æƒé™ï¼Œä»è€Œæœ€å¤§é™åº¦çš„å‡å°‘æ³¨å…¥æ”»å‡»å¯¹æ•°æ®åº“çš„å±å®³ã€‚</li></ul><blockquote><p>æ­£åˆ™åŒ¹é… å­—ç¬¦è½¬ä¹‰</p></blockquote><ul><li><code>const reg = /select|update|delete|exec|count|&#x27;|&quot;|=|;|&gt;|&lt;|%/i;</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç‚¹å‡»åŠ«æŒ"></a>ç‚¹å‡»åŠ«æŒ<a class="hash-link" href="#ç‚¹å‡»åŠ«æŒ" title="Direct link to heading">#</a></h3><ul><li>é€šè¿‡è¦†ç›–ä¸å¯è§çš„æ¡†æ¶è¯¯å¯¼å—å®³è€…ç‚¹å‡»<ul><li>ä½¿ç”¨ä¸€ä¸ªé€æ˜çš„<code>iframe</code>ï¼Œè¦†ç›–åœ¨ä¸€ä¸ªç½‘é¡µä¸Šï¼Œè¯±ä½¿ç”¨æˆ·åœ¨è¯¥é¡µé¢ä¸Šè¿›è¡Œæ“ä½œ</li><li>ä½¿ç”¨ä¸€å¼ å›¾ç‰‡è¦†ç›–åœ¨ç½‘é¡µï¼Œé®æŒ¡ç½‘é¡µåŸæœ‰ä½ç½®çš„å«ä¹‰</li></ul></li></ul><p>ä½¿ç”¨ HTTP å¤´ <code>X-Frame-Options</code> è¿›è¡Œæ”»å‡»é˜²å¾¡è¿™ä¸ª</p><ul><li><code>deny</code>ï¼šè¡¨ç¤ºè¯¥é¡µé¢ä¸å…è®¸åœ¨ <code>frame</code> ä¸­å±•ç¤ºï¼Œå³ä¾¿æ˜¯åœ¨ç›¸åŒåŸŸåçš„é¡µé¢ä¸­åµŒå¥—ä¹Ÿä¸å…è®¸</li><li><code>sameorigin</code>ï¼šè¡¨ç¤ºè¯¥é¡µé¢å¯ä»¥åœ¨ç›¸åŒåŸŸåé¡µé¢çš„ <code>frame</code> ä¸­å±•ç¤º</li><li><code>allow-form url</code>ï¼šè¡¨ç¤ºè¯¥é¡µé¢å¯ä»¥åœ¨æŒ‡å®šæ¥æºçš„ <code>frame</code> ä¸­å±•ç¤º</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Ref</h5></div><div class="admonition-content"><ul><li><a href="https://zhuanlan.zhihu.com/p/83865185" target="_blank" rel="noopener noreferrer">å‰ç«¯å®‰å…¨</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/09/csp.html" target="_blank" rel="noopener noreferrer">Content Security Policy å…¥é—¨æ•™ç¨‹</a></li><li><a href="https://juejin.cn/post/6951571103953190925" target="_blank" rel="noopener noreferrer">ä¸€ã€web å®‰å…¨ï¼ˆxss/csrfï¼‰ç®€å•æ”»å‡»åŸç†å’Œé˜²å¾¡æ–¹æ¡ˆï¼ˆç†è®ºç¯‡ï¼‰</a></li></ul></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">é‡‡ç”¨https æˆ–è€… ä»£ç å±‚é¢ä¹Ÿå¯ä»¥åšå®‰å…¨æ£€æµ‹ï¼Œæ¯”å¦‚ipåœ°å€å‘ç”Ÿå˜åŒ–ï¼Œ</span><span class="token constant" style="color:#36acaa">MAC</span><span class="token plain">åœ°å€å‘ç”Ÿå˜åŒ–ç­‰ç­‰ï¼Œå¯ä»¥è¦æ±‚é‡æ–°ç™»å½•</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">aã€åœ¨å­˜å‚¨çš„æ—¶å€™æŠŠ token è¿›è¡Œå¯¹ç§°åŠ å¯†å­˜å‚¨ï¼Œç”¨æ—¶è§£å¼€ã€‚</span></span><span class="token-line" style="color:#393A34"><span class="token plain">bã€å°†è¯·æ±‚ </span><span class="token constant" style="color:#36acaa">URL</span><span class="token plain">ã€æ—¶é—´æˆ³ã€token ä¸‰è€…è¿›è¡Œåˆå¹¶åŠ ç›ç­¾åï¼ŒæœåŠ¡ç«¯æ ¡éªŒæœ‰æ•ˆæ€§ã€‚</span></span><span class="token-line" style="color:#393A34"><span class="token plain">cã€</span><span class="token constant" style="color:#36acaa">HTTPS</span><span class="token plain"> å¯¹ </span><span class="token constant" style="color:#36acaa">URL</span><span class="token plain"> è¿›è¡Œåˆ¤æ–­ã€‚</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">è·å–çš„tokenåŠ å¯†åå­˜å‚¨ è§£å¯†å å¤´éƒ¨æºå¸¦</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å†…å®¹å®‰å…¨ç­–ç•¥ csp</p><ul><li><code>Content Security Policy</code> å†…å®¹å®‰å…¨ç­–ç•¥</li><li>å®è´¨ï¼šç™½åå•åˆ¶åº¦ï¼Œå¼€å‘è€…æ˜ç¡®å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå“ªäº›å¤–éƒ¨èµ„æºå¯ä»¥åŠ è½½å’Œæ‰§è¡Œ</li></ul><ul><li><p><a href="https://blog.csdn.net/menghuanzhiming/article/details/102736312?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link" target="_blank" rel="noopener noreferrer">ajaxè¯·æ±‚æºå¸¦cookieå’Œè‡ªå®šä¹‰è¯·æ±‚å¤´headerï¼ˆè·¨åŸŸå’ŒåŒåŸŸï¼‰</a></p></li><li><p>ajaxä¼šè‡ªåŠ¨å¸¦ä¸ŠåŒæºçš„cookieï¼Œä¸ä¼šå¸¦ä¸Šä¸åŒæºçš„cookie</p></li><li><p>å¯ä»¥é€šè¿‡<strong>å‰ç«¯è®¾ç½®withCredentialsä¸ºtrueï¼Œ åç«¯è®¾ç½®Header</strong>çš„æ–¹å¼è®©ajaxè‡ªåŠ¨å¸¦ä¸Šä¸åŒæºçš„cookieï¼Œä½†æ˜¯è¿™ä¸ªå±æ€§å¯¹åŒæºè¯·æ±‚æ²¡æœ‰ä»»ä½•å½±å“ã€‚ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ã€‚</p></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">ajaxè·¨åŸŸè¯·æ±‚ä¸‹ï¼Œajaxä¸ä¼šè‡ªåŠ¨æºå¸¦åŒæºçš„cookieï¼Œéœ€è¦é€šè¿‡å‰ç«¯é…ç½®ç›¸åº”å‚æ•°æ‰å¯ä»¥è·¨åŸŸæºå¸¦åŒæºcookieï¼Œåå°é…ç½®ç›¸åº”å‚æ•°æ‰å¯ä»¥è·¨åŸŸè¿”å›åŒæºcookieï¼›</span></span><span class="token-line" style="color:#393A34"><span class="token plain">å‰ç«¯å‚æ•°ï¼š</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    withCredentials</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">å‘é€Ajaxæ—¶ï¼ŒRequest headerä¸­ä¼šå¸¦ä¸ŠCookieä¿¡æ¯</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">åå°å‚æ•°ï¼š</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ï¼ˆ</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">ï¼‰</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Access</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Control</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Allow</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Originï¼šè®¾ç½®å…è®¸è·¨åŸŸçš„é…ç½®ï¼Œ</span><span class="token plain"> å“åº”å¤´æŒ‡å®šäº†è¯¥å“åº”çš„èµ„æºæ˜¯å¦è¢«å…è®¸ä¸ç»™å®šçš„originå…±äº«ï¼›</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        ç‰¹åˆ«è¯´æ˜ï¼šé…ç½®äº†Access</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Control</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Allow</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Credentials</span><span class="token operator" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain">åˆ™ä¸èƒ½æŠŠAccess</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Control</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Allow</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Originè®¾ç½®ä¸ºé€šé…ç¬¦</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ï¼›</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ï¼ˆ</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">ï¼‰</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Access</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Control</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Allow</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Credentialsï¼šå“åº”å¤´è¡¨ç¤ºæ˜¯å¦å¯ä»¥å°†å¯¹è¯·æ±‚çš„å“åº”æš´éœ²ç»™é¡µé¢ï¼ˆcookieï¼‰ã€‚è¿”å›</span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain">åˆ™å¯ä»¥ï¼Œå…¶ä»–å€¼å‡ä¸å¯ä»¥ã€‚</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">xhrFields</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        withCredentials</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/js/reg"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« æ­£åˆ™</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/js/hand"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">JSå®ç° Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#xhr--fetch" class="table-of-contents__link"><code>Xhr &amp; Fetch</code></a><ul><li><a href="#xmlhttprequest" class="table-of-contents__link"><code>XMLHttpRequest</code></a></li><li><a href="#ajax" class="table-of-contents__link"><code>AJAX</code></a></li><li><a href="#axios" class="table-of-contents__link"><code>axios</code></a></li><li><a href="#fetch" class="table-of-contents__link"><code>Fetch</code></a></li></ul></li><li><a href="#è·¨åŸŸ" class="table-of-contents__link">è·¨åŸŸ</a><ul><li><a href="#åŒæºç­–ç•¥" class="table-of-contents__link">åŒæºç­–ç•¥</a></li><li><a href="#è·¨åŸŸè§£å†³æ–¹æ¡ˆ" class="table-of-contents__link">è·¨åŸŸè§£å†³æ–¹æ¡ˆ</a></li></ul></li><li><a href="#ç™»é™†éªŒè¯" class="table-of-contents__link">ç™»é™†éªŒè¯</a></li><li><a href="#å‰ç«¯ç™»é™†é‰´æƒ" class="table-of-contents__link">å‰ç«¯ç™»é™†é‰´æƒ</a></li><li><a href="#å®‰å…¨" class="table-of-contents__link">å®‰å…¨</a><ul><li><a href="#xss-è·¨ç«™è„šæœ¬æ”»å‡»" class="table-of-contents__link"><code>XSS</code> è·¨ç«™è„šæœ¬æ”»å‡»</a></li><li><a href="#csrf-è·¨ç«™è¯·æ±‚ä¼ªé€ " class="table-of-contents__link"><code>CSRF</code> è·¨ç«™è¯·æ±‚ä¼ªé€ </a></li><li><a href="#sql-æ³¨å…¥" class="table-of-contents__link"><code>sql</code> æ³¨å…¥</a></li><li><a href="#ç‚¹å‡»åŠ«æŒ" class="table-of-contents__link">ç‚¹å‡»åŠ«æŒ</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.fde05104.js"></script>
<script src="/assets/js/main.a852bf25.js"></script>
</body>
</html>