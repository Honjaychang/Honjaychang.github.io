<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="HonjayChang Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="HonjayChang Blog Atom Feed"><title data-react-helmet="true">renderé˜¶æ®µ | HonjayChang</title><meta data-react-helmet="true" property="og:url" content="https://honjaychang.github.io//docs/reactCore/render"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="renderé˜¶æ®µ | HonjayChang"><meta data-react-helmet="true" name="description" content="image-20211002152401431"><meta data-react-helmet="true" property="og:description" content="image-20211002152401431"><link data-react-helmet="true" rel="shortcut icon" href="/img/photo.ico"><link data-react-helmet="true" rel="canonical" href="https://honjaychang.github.io//docs/reactCore/render"><link data-react-helmet="true" rel="alternate" href="https://honjaychang.github.io//docs/reactCore/render" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://honjaychang.github.io//docs/reactCore/render" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.6b743985.css">
<link rel="preload" href="/assets/js/runtime~main.7bae2b1a.js" as="script">
<link rel="preload" href="/assets/js/main.df3858a9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://honjaychang.github.io/docs/home" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img src="/img/photo.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/photo.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/Home">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Honjaychang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Home">Home</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">HC</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">JS</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Extension</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">TS</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">React</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">ReactCore</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reactCore/basic">ä¸€äº›æ¦‚å¿µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reactCore/ds">æ•°æ®ç»“æ„å®šä¹‰</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reactCore/createUpdate">æ›´æ–°æµç¨‹</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/reactCore/render">renderé˜¶æ®µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reactCore/commit">commité˜¶æ®µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reactCore/scheduler">è°ƒåº¦å™¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reactCore/reconciler">åè°ƒå™¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reactCore/event">Reactäº‹ä»¶æœºåˆ¶</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Dev</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Algo</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Interview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Vue</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">renderé˜¶æ®µ</h1></header><p><img src="https://cdn.jsdelivr.net/gh/honjaychang/bp/fe/20211002152401.png" alt="image-20211002152401431"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ¦‚è¿°"></a>æ¦‚è¿°<a class="hash-link" href="#æ¦‚è¿°" title="Direct link to heading">#</a></h2><p><code>render</code> é˜¶æ®µ</p><blockquote><p>React åº”ç”¨ç¨‹åºé¦–æ¬¡æ¸²æŸ“æ—¶æ„å»º <code>workInProgress</code> æ ‘çš„è¿‡ç¨‹ä¹Ÿæ˜¯å°† <code>React</code> å…ƒç´ æ ‘è½¬åŒ–ä¸º <code>Fiber</code> æ ‘çš„è¿‡ç¨‹ï¼Œ <code>workInProgress</code> æ ‘æ„å»ºå®Œæˆåä¼šåœ¨è¯¥ã€Œæ ‘ã€ä¸Šé¢å®Œæˆæ›´æ–°è®¡ç®—ã€è°ƒç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä»¥åŠæ”¶é›†å‰¯ä½œç”¨åˆ—è¡¨ç­‰å·¥ä½œã€‚</p><p>åº”ç”¨ç¨‹åºæ¸²æŸ“æ—¶åœ¨ <code>render</code> é˜¶æ®µçš„ä¸€ä¸ªé‡è¦å·¥ä½œå°±æ˜¯æ„å»º <code>workInProgress</code> æ ‘ï¼Œæ„å»º <code>workInProgress</code> æ ‘çš„è¿‡ç¨‹ä¸­ <code>React</code> ä¹Ÿä¼šå®Œæˆæ›´æ–°è®¡ç®—ã€è°ƒç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä»¥åŠæ”¶é›†å‰¯ä½œç”¨åˆ—è¡¨ç­‰å·¥ä½œ</p><p>Reactçš„æ›´æ–°ä»»åŠ¡ä¸»è¦æ˜¯è°ƒç”¨<code>workLoop</code>çš„å·¥ä½œå¾ªç¯å»æ„å»º<code>workInProgress</code>æ ‘ï¼Œ æ„å»ºè¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šå‘ä¸‹éå†å’Œå‘ä¸Šå›æº¯ï¼Œå‘ä¸‹å’Œå‘ä¸Šçš„è¿‡ç¨‹ä¸­ä¼šå¯¹é€”å¾„çš„æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œ<code>beginWork</code> å’Œ<code>completeWork</code></p></blockquote><p><code>beginWork</code></p><ul><li>æ˜¯å¤„ç†èŠ‚ç‚¹æ›´æ–°çš„å…¥å£ï¼Œå®ƒä¼šä¾æ®<code>fiber</code> èŠ‚ç‚¹çš„ç±»å‹å»è°ƒç”¨ä¸åŒçš„å¤„ç†å‡½æ•°</li><li>Reactå¯¹<code>current</code>æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œ<code>beginWork</code> æ“ä½œï¼Œè¿›å…¥<code>beginWork</code> åï¼Œé¦–å…ˆåˆ¤æ–­èŠ‚ç‚¹åŠå…¶å­æ ‘æ˜¯å¦æœ‰æ›´æ–°ï¼Œè‹¥æœ‰æ›´æ–°ï¼Œåˆ™ä¼šåœ¨è®¡ç®—æ–°çŠ¶æ€å’Œ<code>diff</code>ä¹‹åç”Ÿæˆæ–°çš„<code>fiber</code>ï¼Œ ç„¶ååœ¨æ–°çš„<code>fiber</code>ä¸Šæ ‡è®°<code>effectTag</code>ï¼Œæœ€å<code>return</code>å®ƒçš„å­èŠ‚ç‚¹ï¼Œä»¥ä¾¿ç»§ç»­é’ˆå¯¹å­èŠ‚ç‚¹è¿›è¡Œ<code>beginWork</code>ã€‚è‹¥å®ƒæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™è¿”å›<code>null</code>ï¼Œè¿™æ ·è¯´æ˜è¿™ä¸ªèŠ‚ç‚¹æ˜¯æœ«ç«¯èŠ‚ç‚¹ï¼Œ å¯ä»¥è¿›è¡Œå‘ä¸Šå›æº¯ï¼Œè¿›å…¥<code>completeWork</code>é˜¶æ®µã€‚</li><li>è®¡ç®—æ–°çŠ¶æ€ <code>update</code> <code>updateQueue</code> <code>processUpdateQueue</code><ul><li>å‡†å¤‡é˜¶æ®µ - æ•´ç†<code>updateQueue</code> ä¸Šæ¬¡é—ç•™çš„ æœ¬æ¬¡æ–°å¢çš„</li><li>å¤„ç†é˜¶æ®µ - å¾ªç¯å¤„ç†ä¸Šä¸€æ­¥æ•´ç†å¥½çš„æ›´æ–°é˜Ÿåˆ— ä¼˜å…ˆçº§</li><li>å®Œæˆé˜¶æ®µ - ä¸»è¦æ˜¯åšä¸€äº›èµ‹å€¼å’Œä¼˜å…ˆçº§æ ‡è®°çš„å·¥ä½œ</li></ul></li><li><code>Diff</code>ç®—æ³•<ul><li>ç»è¿‡çŠ¶æ€è®¡ç®—å å·²ç»è·å–åˆ°äº†æ–°çš„ <code>fiber</code> åœ¨<code>render</code>ä¹‹å‰ éœ€è¦<code>diff</code> æ“ä½œ æ‰“ä¸Š <code>effectTag</code>  (å¯ä»¥æ ‡è¯†è¿™ä¸ª<code>fiber</code>å‘ç”Ÿäº†æ€æ ·çš„å˜åŒ–ï¼Œä¾‹å¦‚ï¼šæ–°å¢<code>Placement</code> ï¼Œè¿™äº›è¢«æ‰“ä¸Š<code>flag</code> çš„<code>fiber</code>ä¼šåœ¨<code>complete</code>é˜¶æ®µè¢«æ”¶é›†èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ª<code>effectList</code>é“¾è¡¨ï¼ŒåªåŒ…å«è¿™äº›éœ€è¦æ“ä½œçš„<code>fiber</code>ï¼Œæœ€ååœ¨<code>commit</code>é˜¶æ®µè¢«æ›´æ–°æ‰)</li><li><code>diff</code> çš„ä¸»ä½“æ˜¯ <code>oldFiber (current.child)</code> å’Œ <code>new React Element (nextChildren)</code></li><li><code>diff</code> çš„åŸåˆ™  ç›´æ¥é”€æ¯é‡å»º  ä»¥åŠ ä¾æ®<code>key tag</code>å¤ç”¨</li><li>åœ¨ <code>diff</code> è¿‡åï¼Œ<code>workInProgress</code>èŠ‚ç‚¹çš„<code>beginWork</code>èŠ‚ç‚¹å°±å®Œæˆäº†ã€‚æ¥ä¸‹æ¥ä¼šè¿›å…¥<code>completeWork</code>é˜¶æ®µ</li></ul></li></ul><p><code>completeWork</code></p><ul><li>è¿›å…¥<code>completeWork</code> åçš„<code>workInProgress</code> èŠ‚ç‚¹éƒ½æ˜¯ç»è¿‡<code>diff</code>ç®—æ³•è°ƒå’Œè¿‡çš„ï¼ŒèŠ‚ç‚¹çš„<code>fiber</code>çš„å½¢æ€å·²ç»åŸºæœ¬ç¡®å®šäº†ï¼Œä½†å¯¹äºåŸç”ŸDOMç»„ä»¶å’Œæ–‡æœ¬èŠ‚ç‚¹çš„ <code>fiber</code> æ¥è¯´ï¼Œå¯¹åº”çš„DOMèŠ‚ç‚¹å¹¶æœªå˜åŒ–</li><li>è¿™ä¸ªé˜¶æ®µä¸»è¦å°±æ˜¯ä¸¤ä¸ªå·¥ä½œ<ul><li>æ„å»ºæˆ–æ›´æ–°DOMèŠ‚ç‚¹</li><li>è‡ªä¸‹è€Œä¸Šæ”¶é›†<code>effectList</code>ï¼Œæœ€ç»ˆæ”¶é›†åˆ°<code>root</code>ä¸Š</li></ul></li><li>ä¾æ®<code>fiber</code>çš„<code>tag</code>åšä¸åŒå¤„ç†ã€‚DOMèŠ‚ç‚¹çš„æ›´æ–°å®åˆ™æ˜¯å±æ€§çš„æ›´æ–°</li></ul><p>æ”¶é›†å¥½çš„å‰¯ä½œç”¨åˆ—è¡¨ä¼šåœ¨ <code>commit</code> é˜¶æ®µç»Ÿä¸€æ˜ å°„åˆ°å±å¹•ä¸Š</p><ul><li>åˆ›å»º<code>wIP</code> æ ‘</li><li>è®¡ç®—æ–°çŠ¶æ€</li><li>è¿›è¡Œ<code>diff</code> æ ‡è®°<code>effectTag</code></li><li>æ„å»ºæˆ–æ›´æ–°DOMèŠ‚ç‚¹</li><li>æ”¶é›†å½¢æˆ <code>effect List</code></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="beginwork"></a><code>beginWork</code><a class="hash-link" href="#beginwork" title="Direct link to heading">#</a></h2><blockquote><p>ä»åˆå§‹åŒ– <code>workInProgress</code> å¯¹è±¡åˆ°å½¢æˆ <code>workInProgress</code> æ ‘ï¼Œåº”ç”¨ç¨‹åºä¼šæ‰§è¡Œå¤šæ¬¡å¾ªç¯ï¼Œæ¯ä¸€æ¬¡å¾ªç¯éƒ½æ˜¯åœ¨è§£æ <code>Fiber</code> ç»“ç‚¹å¹¶è¿”å›ä¸‹ä¸€ä¸ªè¦è§£æçš„ç»“ç‚¹ã€‚è¿™ ä¸ªè¿‡ç¨‹ä¸­ä¼šä½¿ç”¨é‡è¦çš„ã€Œåè°ƒã€ç®—æ³•ï¼Œå¯¹ç»“ç‚¹è¿›è¡Œ <code>diff</code> æ“ä½œ</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ„å»º-wip-æ ‘"></a>æ„å»º <code>wIP</code> æ ‘<a class="hash-link" href="#æ„å»º-wip-æ ‘" title="Direct link to heading">#</a></h3><blockquote><p>æ­¤é˜¶æ®µ <code>React</code> å°†å…ƒç´ é€ä¸ªè½¬æ¢ä¸ºå¯¹åº”ç±»å‹çš„ <code>Fiber</code> ç»“ç‚¹ï¼Œæœ€ç»ˆå½¢æˆ <code>workInProgress</code> æ ‘</p></blockquote><p>åº”ç”¨ç¨‹åºé¦–æ¬¡æ¸²æŸ“è¿‡ç¨‹åˆšè¿›å…¥ <code>render</code> é˜¶æ®µæ—¶ <code>fiberRoot</code> å¯¹è±¡ä¸Šé¢åªæœ‰ <code>current</code> æ ‘ï¼Œæ­¤æ—¶çš„ <code>current</code> æ ‘åªæœ‰ä¸€ä¸ªç±»å‹ä¸º <code>HostRoot</code> çš„ <code>Fiber</code> ç»“ç‚¹ï¼Œè¯¥ <code>Fiber</code> ç»“ç‚¹çš„æ›´æ–°é˜Ÿåˆ—ä¸­åªæœ‰ä¸€ä¸ªæ›´æ–°å¯¹è±¡ï¼Œå†…å®¹æ˜¯åº”ç”¨ç¨‹åºçš„æ ¹ç»„ä»¶å…ƒç´ ã€‚ç´§æ¥ç€ <code>React</code> è¦åšçš„å°±æ˜¯åˆå§‹åŒ– <code>workInProgress</code> å¯¹è±¡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/honjaychang/bp/fe/20211001131338.png" alt="image-20211001131338587"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åˆå§‹åŒ–-wip-å¯¹è±¡"></a>åˆå§‹åŒ– <code>wIP</code> å¯¹è±¡<a class="hash-link" href="#åˆå§‹åŒ–-wip-å¯¹è±¡" title="Direct link to heading">#</a></h4><ul><li><code>renderRoot</code> è°ƒç”¨ <code>createWorkInProgress</code> ä¸º <code>workInProgress</code> å¯¹è±¡èµ‹åˆå§‹å€¼</li><li>å‡½æ•°è°ƒç”¨å <code>wIP</code> å¯¹è±¡ä¸Šæœ‰äº†ç¬¬ä¸€ä¸ª<code>Fiber</code>ç»“ç‚¹ï¼Œç»“ç‚¹çš„<code>tag</code>ä¸º<code>HostRoot</code> æ˜¯æ•´ä¸ª<code>wIP</code>æ ‘çš„æ ¹èŠ‚ç‚¹</li></ul><p><img src="https://cdn.jsdelivr.net/gh/honjaychang/bp/fe/20211001132001.png" alt="image-20211001132001247"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®Œå–„-wip-å¯¹è±¡"></a>å®Œå–„ <code>wIP</code> å¯¹è±¡<a class="hash-link" href="#å®Œå–„-wip-å¯¹è±¡" title="Direct link to heading">#</a></h4><ul><li>è¦æƒ³æŠŠç»„ä»¶å…ƒç´ æè¿°çš„é¡µé¢ç»“æ„æ˜ å°„åˆ°å±å¹•ä¸Šå¿…é¡»å…ˆå°†å…ƒç´ è½¬æ¢ä¸º <code>Fiber</code> ç»“ç‚¹</li><li>å®Œå–„<code>wIP</code> å¯¹è±¡çš„è¿‡ç¨‹å°±æ˜¯ å°† <code>React</code> å…ƒç´ æ ‘è½¬åŒ–ä¸º <code>Fiber</code> æ ‘çš„è¿‡ç¨‹</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å·¥ä½œå¾ªç¯"></a>å·¥ä½œå¾ªç¯<a class="hash-link" href="#å·¥ä½œå¾ªç¯" title="Direct link to heading">#</a></h3><blockquote><p>React é€šè¿‡å·¥ä½œå¾ªç¯æ¥æ„å»º<code>workInProgress</code> </p><p>ä¸¤ä¸ªå…³é”®ç¯èŠ‚ è§£æå·¥ä½œå•å…ƒ å®Œæˆå·¥ä½œå•å…ƒ</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¾ªç¯è§£æå·¥ä½œå•å…ƒ"></a>å¾ªç¯è§£æå·¥ä½œå•å…ƒ<a class="hash-link" href="#å¾ªç¯è§£æå·¥ä½œå•å…ƒ" title="Direct link to heading">#</a></h4><ul><li>å·¥ä½œå¾ªç¯ä¸»è¦æ˜¯æ‰§è¡Œ <code>workLoop</code> å‡½æ•°æ¥å¾ªç¯è§£æå·¥ä½œå•å…ƒã€‚æ¯æ¬¡å¾ªç¯è§£æçš„å·¥ä½œå•å…ƒå°±æ˜¯ä¸Šä¸€æ¬¡ <code>Fiber</code> ç»“ç‚¹çš„ <code>child</code>ã€‚</li><li>ç¬¬ä¸€æ¬¡å¾ªç¯è§£æçš„æ˜¯ <code>HostRoot</code> ç±»å‹çš„ç»“ç‚¹ï¼Œè¯¥ç»“ç‚¹ä¹Ÿå°±æ˜¯æ‰€æœ‰ç»“ç‚¹çš„ç¥–å…ˆ</li><li>å·¥ä½œå•å…ƒå…·ä½“çš„è§£æé€»è¾‘åœ¨ <code>performUnitOfWork</code> ä¸­è°ƒç”¨</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è§£æå·¥ä½œå•å…ƒ"></a>è§£æå·¥ä½œå•å…ƒ<a class="hash-link" href="#è§£æå·¥ä½œå•å…ƒ" title="Direct link to heading">#</a></h4><p>åœ¨ <code>beginWork</code> å‡½æ•°å†…éƒ¨é€šè¿‡åŒ¹é… <code>Fiber</code> ç»“ç‚¹çš„ <code>tag</code> å€¼è°ƒç”¨ <code>updateHostRootã€updateClassComponentã€updateHostComponentã€updateHostText</code> ç­‰å‡½æ•°ï¼Œåˆ†åˆ«è§£æ <code>HostRootã€ClassComponentã€HostComponentã€HostText</code>ç­‰ç±»å‹çš„Fiber ç»“ç‚¹ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®Œæˆå·¥ä½œå•å…ƒ"></a>å®Œæˆå·¥ä½œå•å…ƒ<a class="hash-link" href="#å®Œæˆå·¥ä½œå•å…ƒ" title="Direct link to heading">#</a></h4><p>å³<code>completeWork</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è§£æä¸åŒç±»å‹fiberç»“ç‚¹"></a>è§£æä¸åŒç±»å‹<code>Fiber</code>ç»“ç‚¹<a class="hash-link" href="#è§£æä¸åŒç±»å‹fiberç»“ç‚¹" title="Direct link to heading">#</a></h3><p>åº”ç”¨ç¨‹åºé¦–æ¬¡æ¸²æŸ“æ—¶ï¼Œå°†æ ¹ç»„ä»¶å…ƒç´ è½¬æ¢ä¸ºå¤šä¸ªå±‚çº§çš„ <code>Fiber</code> ç»“ç‚¹è¿‡ç¨‹ä¸­ï¼Œç¬¬ä¸€æ­¥è¦åšçš„å°±æ˜¯è§£æ <code>wIP</code> æ ‘çš„æ ¹ç»“ç‚¹ <code>HostRoot</code></p><p><img src="https://cdn.jsdelivr.net/gh/honjaychang/bp/fe/20211001140433.png" alt="image-20211001140433792"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="hostroot-ç±»å‹"></a><code>HostRoot</code> ç±»å‹<a class="hash-link" href="#hostroot-ç±»å‹" title="Direct link to heading">#</a></h4><ul><li><code>updateHostRoot -&gt; processUpdateQueue</code></li><li>è§£æ <code>HostRoot</code>ç±»å‹ç»“ç‚¹çš„å…³é”®æ˜¯å¤„ç†æ›´æ–°é˜Ÿåˆ— <code>processUpdateQueue</code> è·å–æ ¹ç»„ä»¶å…ƒç´  <code>element</code>ï¼Œ<code>element </code>å°±æ˜¯è¦ä¼ å…¥åˆ°åè°ƒç®—æ³•ä¸­è¿›è¡Œè§£æçš„<code>nextChildren</code></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateHostRoot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">current$$</span><span class="token parameter number" style="color:#36acaa">1</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> workInProgress</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">pushHostRootContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workInProgress</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> updateQueue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">updateQueue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> nextProps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pendingProps</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> prevState </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">memoizedState</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> prevChildren </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> prevState </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> prevState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">element</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">processUpdateQueue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> updateQueue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nextProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> nextState </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">memoizedState</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Caution: React DevTools currently depends on this property</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// being called &quot;element&quot;.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> nextChildren </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">element</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nextChildren </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> prevChildren</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// If the state is the same as before, that&#x27;s a bailout because we had</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// no work that expires at this time.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">resetHydrationState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bailoutOnAlreadyFinishedWork</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">current$$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> root </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">stateNode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">current$$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> current$$</span><span class="token number" style="color:#36acaa">1.</span><span class="token plain">child </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> root</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hydrate</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">enterHydrationState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workInProgress</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// If we don&#x27;t have any current children this might be the first pass.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// We always try to hydrate. If this isn&#x27;t a hydration pass there won&#x27;t</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// be any children to hydrate which is effectively the same thing as</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// not hydrating.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// This is a bit of a hack. We track the host root as a placement to</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// know that we&#x27;re currently in a mounting state. That way isMounted</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// works as expected. We must reset this before committing.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// TODO: Delete this when we delete isMounted and findDOMNode.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">effectTag</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token maybe-class-name">Placement</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Ensure that children mount into this root without tracking</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// side-effects. This ensures that we don&#x27;t store Placement effects on</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// nodes that will be hydrated.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">child</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mountChildFibers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nextChildren</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Otherwise reset hydration state in case we aborted and resumed another</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// root.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">reconcileChildren</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">current$$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nextChildren</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">resetHydrationState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">child</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="classcomponent-ç±»å‹"></a><code>ClassComponent</code> ç±»å‹<a class="hash-link" href="#classcomponent-ç±»å‹" title="Direct link to heading">#</a></h4><ul><li>åº”ç”¨ç¨‹åºé¦–æ¬¡æ¸²æŸ“æ—¶è§£æ <code>HostRoot</code> ç±»å‹ç»“ç‚¹å®Œæˆåè¿”å›çš„ä¸€èˆ¬æ˜¯ <code>ClassComponent</code> ç±»å‹çš„ç»“ç‚¹ï¼Œè¿™ç§ç±»å‹çš„ <code>Fiber</code> ç»“ç‚¹è§£æè¿‡ç¨‹ä¸­æ˜¯è¦è¿›è¡Œç»„ä»¶å®ä¾‹åŒ–çš„</li><li>è§£æ<code>ClassComponent</code>ç±»å‹çš„ç»“ç‚¹æ—¶ï¼Œå…ˆä»å½“å‰ <code>Fiber</code> ç»“ç‚¹çš„ <code>stateNode</code> å±æ€§ä¸Šé¢å–ç»„ä»¶å®ä¾‹<code>instance</code>ï¼Œå¦‚æœ <code>instance</code> çš„å€¼ä¸º <code>null</code> åˆ™è¯´æ˜æ˜¯é¦–æ¬¡æ¸²æŸ“ï¼Œç»„ä»¶è¿˜æ²¡æœ‰è¢«å®ä¾‹åŒ–ã€‚React ä½¿ç”¨ <code>constructClassInstance</code> å‡½æ•°å®Œæˆç»„ä»¶å®ä¾‹åŒ–ï¼ŒåŒæ—¶ä¸ºç»„ä»¶å®ä¾‹æ·»åŠ æ›´æ–°å™¨ï¼ˆç„¶åå°±å¯ä»¥è°ƒç”¨ <code>setState</code> </li><li>ç»„ä»¶å®ä¾‹ç”Ÿæˆåï¼Œå®ƒçš„æ ¸å¿ƒä½œç”¨ä¹‹ä¸€å°±æ˜¯åœ¨  <code>finishClassComponent</code>  å‡½æ•°å†…éƒ¨æ‰§è¡Œ <code>instance.render() </code>è·å–è¦ä¼ å…¥åˆ°åè°ƒç®—æ³•ä¸­è¿›è¡Œè§£æçš„ <code>nextChildren</code></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateClassComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">current$$</span><span class="token parameter number" style="color:#36acaa">1</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> workInProgress</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> Component</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> nextProps</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> instance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">stateNode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> shouldUpdate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">instance </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">current$$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// An class component without an instance only mounts if it suspended</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// inside a non- concurrent tree, in an inconsistent state. We want to</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// tree it like a new mount, even though an empty version of it already</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// committed. Disconnect the alternate pointers.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      current$$</span><span class="token number" style="color:#36acaa">1.</span><span class="token plain">alternate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">alternate</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Since this is conceptually a new fiber, schedule a Placement effect</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">effectTag</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token maybe-class-name">Placement</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// In the initial pass we might need to construct the instance.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">constructClassInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nextProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">mountClassInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nextProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    shouldUpdate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">current$$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// In a resume, we&#x27;ll already have an instance we can reuse.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    shouldUpdate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">resumeMountClassInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nextProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    shouldUpdate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateClassInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">current$$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nextProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> nextUnitOfWork </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">finishClassComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">current$$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> shouldUpdate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hasContext</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> nextUnitOfWork</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">finishClassComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">current$$</span><span class="token parameter number" style="color:#36acaa">1</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> workInProgress</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> Component</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> shouldUpdate</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> hasContext</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> renderExpirationTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">child</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="hostcomponent-ç±»å‹"></a><code>HostComponent</code> ç±»å‹<a class="hash-link" href="#hostcomponent-ç±»å‹" title="Direct link to heading">#</a></h4><ul><li>è§£æ <code>ClassComponent</code> ç±»å‹ç»“ç‚¹å®Œæˆåè¿”å›çš„ä¸€èˆ¬æ˜¯ <code>HostComponent</code> ç±»å‹<code>tag</code>çš„ç»“ç‚¹ï¼Œè¿™ç§ç»“ç‚¹çš„å…·ä½“ç±»å‹ <code>elementType</code>å¯¹åº”çš„æ˜¯çœŸå®çš„ <code>DOM</code> æ ‡ç­¾ (å¦‚ <code>div  span ...</code> </li><li>è§£æ <code>HostComponent</code> ç±»å‹ç»“ç‚¹ï¼Œå¯ä»å½“å‰ç»“ç‚¹å¯¹åº”çš„å…ƒç´  <code>props</code> ä¸­è·å–è¦ä¼ å…¥åˆ°åè°ƒç®—æ³•ä¸­è¿›è¡Œè§£æçš„ <code>nextChildren</code></li><li>è¿™é‡Œè¦å¼ºè°ƒä¸€ä¸‹ï¼Œæ— è®ºæ˜¯è§£æ HostRoot ç±»å‹çš„ç»“ç‚¹ï¼Œè¿˜æ˜¯è§£æ <code>HostComponent</code> ç±»å‹çš„ç»“ç‚¹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­è·å–çš„ <code>nextChildren</code> å‡ä¸º <code>React å…ƒç´ </code>ã€‚åœ¨æ‰§è¡Œåè°ƒç®—æ³•çš„è¿‡ç¨‹ä¸­ï¼Œ<code>React</code> å°†è¯¥å…ƒç´ è½¬æ¢æˆå¯¹åº”çš„ <code>Fiber </code>ç»“ç‚¹å¹¶è¿”å›ã€‚</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="hosttext-ç±»å‹"></a><code>HostText</code> ç±»å‹<a class="hash-link" href="#hosttext-ç±»å‹" title="Direct link to heading">#</a></h4><ul><li>å½“è§£æåˆ°å…ƒç´ çš„å¶å­å…ƒç´ æ—¶ï¼Œæ­¤æ—¶å¯¹åº”çš„ <code>Fiber</code> ç»“ç‚¹ç±»å‹ä¸º <code>HostText</code> ã€‚<code>React</code> è®¤ä¸ºæ–‡æœ¬ç±»å‹çš„ <code>Fiber </code>ç»“ç‚¹å·²ç»æ˜¯ç»ˆç‚¹ï¼Œä¸ä¼šå†æœ‰å­©å­ç»“ç‚¹ï¼Œç›´æ¥è¿”å› <code>null</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/honjaychang/bp/fe/20211001145029.png" alt="image-20211001145029076"></p><p>åœ¨å·¥ä½œå¾ªç¯çš„è¿‡ç¨‹ä¸­ï¼Œ<code>React</code> æ€»æ˜¯å…ˆä»å¤–éƒ¨æ ¹èŠ‚ç‚¹å¼€å§‹è§£æï¼Œå½“è§£æåˆ°å¶å­ç»“ç‚¹æ—¶å°±è¦å¼€å§‹å®Œæˆå·¥ä½œå•å…ƒã€‚å®Œæˆå·¥ä½œå•å…ƒæ—¶å¦‚æœæœ‰å…„å¼Ÿç»“ç‚¹æ—¶åˆ™éœ€è¦ç»§ç»­è§£æå…„å¼Ÿç»“ç‚¹ï¼Œç„¶åå®Œæˆå…„å¼Ÿç»“ç‚¹åä¼šé€å±‚å‘ä¸Šå®Œæˆå·¥ä½œå•å…ƒã€‚</p><p>å·¥ä½œå•å…ƒè§£ææ‰§è¡Œåˆ° <code>workInProgress</code> æ ‘çš„å¶å­ç»“ç‚¹æ—¶ï¼Œä¼šå®Œæˆå½“å‰å·¥ä½œå•å…ƒã€‚å®Œæˆå·¥ä½œå•å…ƒçš„ä¸»è¦å·¥ä½œæ˜¯æ”¶é›†å‰¯ä½œç”¨ï¼ŒåŒæ—¶å¤„ç† <code>HostComponent</code> ç±»å‹çš„ç»“ç‚¹ï¼Œåˆ›å»ºå¯¹åº”çš„ <code>DOM</code> å…ƒç´ å¹¶å°†ä»–ä»¬ <code>append</code> åˆ°çˆ¶ç»“ç‚¹ä¸Š</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="completework"></a><code>completeWork</code><a class="hash-link" href="#completework" title="Direct link to heading">#</a></h2><p>åœ¨ <code>Diff</code> ä¹‹åï¼Œ<code>workInProgress</code>èŠ‚ç‚¹å°±ä¼šè¿›å…¥<code>complete</code>é˜¶æ®µ</p><p>è¿™ä¸ªæ—¶å€™æ‹¿åˆ°çš„<code>workInProgress</code>èŠ‚ç‚¹éƒ½æ˜¯ç»è¿‡<code>diff</code>ç®—æ³•è°ƒå’Œè¿‡çš„ï¼Œä¹Ÿå°±æ„å‘³ç€å¯¹äºæŸä¸ªèŠ‚ç‚¹æ¥è¯´å®ƒ<code>fiber</code>çš„å½¢æ€å·²ç»åŸºæœ¬ç¡®å®šäº†ï¼Œä½†é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸¤ç‚¹ï¼š</p><ul><li>ç›®å‰åªæœ‰<code>fiber</code>å½¢æ€å˜äº†ï¼Œå¯¹äºåŸç”ŸDOMç»„ä»¶ <code>HostComponent</code> å’Œæ–‡æœ¬èŠ‚ç‚¹ <code>HostText</code> çš„<code>fiber</code>æ¥è¯´ï¼Œå¯¹åº”çš„DOMèŠ‚ç‚¹ <code>fiber.stateNode</code> å¹¶æœªå˜åŒ–</li><li>ç»è¿‡<code>Diff</code>ç”Ÿæˆçš„æ–°çš„<code>workInProgress</code>èŠ‚ç‚¹æŒæœ‰äº†<code>flag</code> å³<code>effectTag</code></li></ul><p>åŸºäºè¿™ä¸¤ä¸ªç‰¹ç‚¹ï¼Œ<code>completeWork</code>çš„å·¥ä½œä¸»è¦æœ‰ï¼š</p><ul><li>æ„å»ºæˆ–æ›´æ–°DOMèŠ‚ç‚¹ (ä¸º <code>HostComponent</code> ç±»å‹çš„ç»“ç‚¹åˆ›å»º <code>DOM</code> å…ƒç´ å®ä¾‹)<ul><li>æ„å»ºè¿‡ç¨‹ä¸­ï¼Œä¼šè‡ªä¸‹è€Œä¸Šå°†å­èŠ‚ç‚¹çš„ç¬¬ä¸€å±‚ç¬¬ä¸€å±‚æ’å…¥åˆ°å½“å‰èŠ‚ç‚¹ã€‚</li><li>æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œä¼šè®¡ç®—DOMèŠ‚ç‚¹çš„å±æ€§ï¼Œä¸€æ—¦å±æ€§éœ€è¦æ›´æ–°ï¼Œä¼šä¸ºDOMèŠ‚ç‚¹å¯¹åº”çš„<code>workInProgress</code> èŠ‚ç‚¹æ ‡è®°<code>Update</code> çš„ <code>effectTag</code></li></ul></li><li>è‡ªä¸‹è€Œä¸Šæ”¶é›†å‰¯ä½œç”¨ <code>effectList</code>ï¼Œæœ€ç»ˆæ”¶é›†åˆ° <code>root</code>ä¸Š</li><li>é”™è¯¯å¤„ç†</li></ul><p><img src="https://cdn.jsdelivr.net/gh/honjaychang/bp/fe/20211011102119.png" alt="image-20211011102119660"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="domèŠ‚ç‚¹çš„åˆ›å»ºæ’å…¥"></a>DOMèŠ‚ç‚¹çš„åˆ›å»ºæ’å…¥<a class="hash-link" href="#domèŠ‚ç‚¹çš„åˆ›å»ºæ’å…¥" title="Direct link to heading">#</a></h3><blockquote><p>å®ŒæˆDOMæ ‘çš„åˆ›å»º</p></blockquote><p><strong>DOMçš„æ’å…¥å¹¶ä¸æ˜¯å°†å½“å‰DOMæ’å…¥å®ƒçš„çˆ¶èŠ‚ç‚¹ï¼Œè€Œæ˜¯å°†å½“å‰è¿™ä¸ªDOMèŠ‚ç‚¹çš„ç¬¬ä¸€å±‚å­èŠ‚ç‚¹æ’å…¥åˆ°å®ƒè‡ªå·±çš„ä¸‹é¢</strong></p><ul><li>æ€»æ˜¯ä¼˜å…ˆçœ‹æœ¬èº«å¯å¦æ’å…¥ï¼Œå†å¾€ä¸‹æ‰¾ï¼Œä¹‹åæ‰æ˜¯æ‰¾<code>sibling</code>èŠ‚ç‚¹</li></ul><p>ç”±äº<code>fiber</code>æ ‘å’Œ<code>dom</code>æ ‘çš„å·®å¼‚ï¼Œæ¯ä¸ª<code>fiber</code>èŠ‚ç‚¹ä¸ä¸€å®šå¯¹åº”ä¸€ä¸ª<code>dom</code>èŠ‚ç‚¹ï¼Œä½†ä¸€ä¸ª<code>dom</code>èŠ‚ç‚¹ä¸€å®šå¯¹åº”ä¸€ä¸ª<code>fiber</code>èŠ‚ç‚¹</p><p>ç”±äºä¸€ä¸ªåŸç”ŸDOMç»„ä»¶çš„å­ç»„ä»¶æœ‰å¯èƒ½æ˜¯ç±»ç»„ä»¶æˆ–å‡½æ•°ç»„ä»¶ï¼Œæ‰€ä»¥ä¼šä¼˜å…ˆæ£€æŸ¥è‡ªèº«ï¼Œå‘ç°è‡ªå·±ä¸æ˜¯åŸç”ŸDOMç»„ä»¶ï¼Œä¸èƒ½è¢«æ’å…¥åˆ°çˆ¶çº§<code>fiber</code>èŠ‚ç‚¹å¯¹åº”çš„DOMä¸­ï¼Œæ‰€ä»¥è¦å¾€ä¸‹æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°åŸç”ŸDOMç»„ä»¶ï¼Œæ‰§è¡Œæ’å…¥ï¼Œæœ€åå†ä»è¿™ä¸€å±‚æ‰¾åŒçº§çš„fiberèŠ‚ç‚¹ï¼ŒåŒçº§èŠ‚ç‚¹ä¹Ÿä¼šæ‰§è¡Œ<code>å…ˆè‡ªæ£€ï¼Œå†æ£€æŸ¥ä¸‹çº§ï¼Œå†æ£€æŸ¥ä¸‹çº§çš„åŒçº§</code>çš„æ“ä½œã€‚</p><p>èŠ‚ç‚¹çš„æ’å…¥ä¹Ÿæ˜¯æ·±åº¦ä¼˜å…ˆã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸€æ•´ä¸ªæ’å…¥çš„æµç¨‹å¹¶æ²¡æœ‰çœŸçš„å°†DOMæ’å…¥åˆ°çœŸå®çš„é¡µé¢ä¸Šï¼Œå®ƒåªæ˜¯åœ¨æ“ä½œ<code>fiber</code>ä¸Šçš„<code>stateNode</code>ã€‚çœŸå®çš„æ’å…¥DOMæ“ä½œå‘ç”Ÿåœ¨<code>commit</code>é˜¶æ®µã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">              </span><span class="token maybe-class-name">App</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">              div</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">List</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">span</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">       p </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;text node&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">    h1</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">             div</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">       p   </span><span class="token string" style="color:#e3116c">&#x27;text&#x27;</span><span class="token plain">  span</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    h1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>HostComponent</code> å’Œ<code>HostText</code>ç±»å‹çš„ <code>Fiber </code>ç»“ç‚¹æ˜¯æœ‰å¯¹åº”çš„çœŸå® <code>DOM</code> å…ƒç´ ï¼Œå› æ­¤åœ¨å®Œæˆå·¥ä½œå•å…ƒé˜¶æ®µ <code>React</code>è¦ä¸ºå®ƒä»¬åˆ›å»ºè‡ªå·±çš„ <code>DOM</code> å®ä¾‹</p><p>åœ¨å®Œæˆå·¥ä½œå•å…ƒçš„è¿‡ç¨‹ä¸­åˆ†ä¸ºäº†ä¸¤ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯é¦–æ¬¡æ¸²æŸ“å’Œæ›´æ–°æ¸²æŸ“ã€‚</p><ul><li>åº”ç”¨ç¨‹åºé¦–æ¬¡æ¸²æŸ“æ—¶ï¼š<code>React</code> ä¸º <code>HostComponent</code> å’Œ <code>HostText</code> ç±»å‹çš„ <code>Fiber</code> ç»“ç‚¹åˆ›å»ºå¯¹åº”çš„ <code>DOM</code> å®ä¾‹å¹¶å°†å…¶èµ‹å€¼åˆ°ç»“ç‚¹ä¸Šçš„ <code>stateNode</code> å±æ€§ä¸Š</li><li>åº”ç”¨ç¨‹åºæ›´æ–°æ¸²æŸ“æ—¶ï¼š <code>React</code> ä¸éœ€è¦ä¸ºå®ƒä»¬é‡æ–°åˆ›å»º <code>DOM</code> å®ä¾‹ï¼Œè€Œæ˜¯æŠŠæ–°çš„å€¼æ›´æ–°åˆ° <code>DOM</code> å…ƒç´ ä¸­</li></ul><p><code>updateHostComponent</code> å‡½æ•°å’Œ <code>updateHostText</code> å‡½æ•°åˆ†åˆ«ç”¨äºæ›´æ–° DOM å…ƒç´ </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="domå±æ€§çš„å¤„ç†"></a>DOMå±æ€§çš„å¤„ç†<a class="hash-link" href="#domå±æ€§çš„å¤„ç†" title="Direct link to heading">#</a></h3><blockquote><p>å±æ€§çš„åˆ›å»º</p></blockquote><p>ä¸»è¦å°±æ˜¯è°ƒç”¨<code>setInitialDOMProperties</code>å°†å±æ€§ç›´æ¥è®¾ç½®è¿›DOMèŠ‚ç‚¹ï¼ˆäº‹ä»¶åœ¨è¿™ä¸ªé˜¶æ®µç»‘å®šï¼‰</p><blockquote><p>å±æ€§çš„æ›´æ–°</p></blockquote><p>ä»¥<code>HostComponent</code>ä¸ºä¾‹ï¼Œä¼šè°ƒç”¨<code>updateHostComponent</code>å‡½æ•°å¯¹DOMèŠ‚ç‚¹å±æ€§è¿›è¡Œæ›´æ–°</p><ul><li>ä¸»è¦å°±æ˜¯è®¡ç®—æ–°çš„å±æ€§ï¼Œå¹¶æŒ‚è½½åˆ°<code>workInProgress</code>èŠ‚ç‚¹çš„<code>updateQueue</code>ä¸­</li><li>ä¼šè°ƒç”¨<code>diffProperties</code>å¯¹æ¯”<code>lastProps</code>å’Œ<code>nextProps</code>ï¼Œè®¡ç®—å‡º<code>updatePayload</code></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">lastProps</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;className&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;title&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;æ›´æ–°å‰çš„æ ‡é¢˜&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;style&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;color&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;red&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fontSize&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;props&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;è‡ªå®šä¹‰æ—§å±æ€§&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;children&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;æµ‹è¯•divçš„Propså˜åŒ–&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;onClick&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">nextProps</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;className&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;title&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;æ›´æ–°åçš„æ ‡é¢˜&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;style&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;color&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;blue&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fontSize&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;children&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;æµ‹è¯•divçš„Propså˜åŒ–&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;onClick&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// indexä¸ºå¶æ•°çš„æ˜¯keyï¼Œä¸ºå¥‡æ•°çš„æ˜¯value</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string" style="color:#e3116c">&quot;props&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string" style="color:#e3116c">&quot;title&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;æ›´æ–°åçš„æ ‡é¢˜&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string" style="color:#e3116c">&quot;style&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;color&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;blue&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>DOMèŠ‚ç‚¹å±æ€§çš„<code>diff</code>ä¸º<code>workInProgress</code>èŠ‚ç‚¹æŒ‚è½½äº†å¸¦æœ‰æ–°å±æ€§çš„<code>updateQueue</code>ï¼Œä¸€æ—¦èŠ‚ç‚¹çš„<code>updateQueue</code>ä¸ä¸ºç©ºï¼Œå®ƒå°±ä¼šè¢«æ ‡è®°ä¸Š<code>Update</code>çš„<code>effectTag</code>ï¼Œ<code>commit</code>é˜¶æ®µä¼šå¤„ç†<code>updateQueue</code>ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="effecttag-æ”¶é›†"></a><code>effectTag</code> æ”¶é›†<a class="hash-link" href="#effecttag-æ”¶é›†" title="Direct link to heading">#</a></h3><p>ç»è¿‡<code>beginWork</code>å’Œä¸Šé¢å¯¹äºDOMçš„æ“ä½œï¼Œæœ‰å˜åŒ–çš„<code>workInProgress</code>èŠ‚ç‚¹å·²ç»è¢«æ‰“ä¸Šäº†<code>effectTag</code></p><p>åœ¨æ”¶é›†å‰¯ä½œç”¨çš„è¿‡ç¨‹ä¸­ä¸»è¦æœ‰ä¸¤ç§æƒ…å†µ</p><ul><li>ç¬¬ä¸€ç§æƒ…å†µå°±æ˜¯å°†å­æ ‘ä¸Šé¢çš„å‰¯ä½œç”¨åˆ—è¡¨è¿åˆ°çˆ¶ç»“ç‚¹ä¸Šé¢</li><li>ç¬¬äºŒç§æƒ…å†µå°±æ˜¯å¦‚æœå½“å‰ç»“ç‚¹ä¹Ÿæœ‰å‰¯ä½œç”¨æ ‡è¯†ï¼Œåˆ™å°†å½“å‰ç»“ç‚¹ä¹Ÿè¿æ¥åˆ°çˆ¶ç»“ç‚¹çš„å‰¯ä½œç”¨åˆ—è¡¨ä¸­</li></ul><p>äº‹å®ä¸Šï¼Œåº”ç”¨ç¨‹åºé¦–æ¬¡æ¸²æŸ“æ—¶çš„å‰¯ä½œç”¨åˆ—è¡¨å°±æ˜¯æ•´ä¸ª <code>workInProgress</code> æ ‘ï¼Œå› ä¸ºæ•´ä¸ª <code>workInProgress</code> æ ‘çš„ç»“ç‚¹ä¸­æºå¸¦çš„å†…å®¹éƒ½éœ€è¦æ›´æ–°åˆ°å±å¹•ï¼Œè€Œåœ¨åº”ç”¨ç¨‹åºæ›´æ–°æ¸²æŸ“æ—¶å‰¯ä½œç”¨åˆ—è¡¨å°†ä¼šæ˜¯ <code>workInProgress</code> æ ‘çš„å­é›†</p><p>æ¯ä¸ª<code>workInProgress</code>èŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ª<code>firstEffect</code>å’Œ<code>lastEffect</code>ï¼Œæ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œæ¥è¡¨ç¤ºå®ƒè‡ªèº«ä»¥åŠå®ƒçš„å­èŠ‚ç‚¹ä¸Šæ‰€æœ‰æŒæœ‰<code>effectTag</code>çš„<code>workInProgress</code>èŠ‚ç‚¹ã€‚<code>completeWork</code>é˜¶æ®µåœ¨å‘ä¸Šéå†çš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šé€å±‚æ”¶é›†<code>effect</code>é“¾ï¼Œæœ€ç»ˆæ”¶é›†åˆ°<code>root</code>ä¸Šï¼Œä¾›æ¥ä¸‹æ¥çš„<code>commit</code>é˜¶æ®µä½¿ç”¨ã€‚</p><p>åœ¨æ”¶é›†å¥½çš„å‰¯ä½œç”¨åˆ—è¡¨ä¸­æ¯ä¸ª <code>HostComponent</code> ç±»å‹ <code>Fiber</code> ç»“ç‚¹çš„ <code>stateNode</code> å±æ€§ä¸­å­˜å‚¨äº†å½“å‰ç»“ç‚¹å¯¹åº”çš„ <code>DOM</code> å®ä¾‹ã€‚é‚£ä¹ˆï¼Œ<code>React</code> ä¸‹ä¸€æ­¥è¦åšçš„å°±æ˜¯å°†å‰¯ä½œç”¨åˆ—è¡¨ä¸­çš„æ‰€æœ‰ <code>DOM</code> å®ä¾‹æ›´æ–°åˆ°å±å¹•ä¸­</p><p><code>completeWork</code>é˜¶æ®µå¤„åœ¨<code>beginWork</code>ä¹‹åï¼Œ<code>commit</code>ä¹‹å‰ï¼Œèµ·åˆ°çš„æ˜¯ä¸€ä¸ªæ‰¿ä¸Šå¯ä¸‹çš„ä½œç”¨ã€‚å®ƒæ¥æ”¶åˆ°çš„æ˜¯ç»è¿‡<code>diff</code>åçš„<code>fiber</code>èŠ‚ç‚¹ï¼Œç„¶åä»–è‡ªå·±è¦å°†DOMèŠ‚ç‚¹å’Œ<code>effectList</code>éƒ½å‡†å¤‡å¥½ã€‚å› ä¸º<code>commit</code>é˜¶æ®µæ˜¯ä¸èƒ½è¢«æ‰“æ–­çš„ï¼Œæ‰€ä»¥å……åˆ†å‡†å¤‡æœ‰åˆ©äº<code>commit</code>é˜¶æ®µåšæ›´å°‘çš„å·¥ä½œã€‚</p><p>ä¸€æ—¦<code>workInProgress</code>æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å®Œæˆ<code>complete</code>ï¼Œåˆ™è¯´æ˜<code>workInProgress</code>æ ‘å·²ç»æ„å»ºå®Œæˆï¼Œæ‰€æœ‰çš„æ›´æ–°å·¥ä½œå·²ç»åšå®Œï¼Œæ¥ä¸‹æ¥è¿™æ£µæ ‘ä¼šè¿›å…¥<code>commit</code>é˜¶æ®µ</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/reactCore/createUpdate"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« æ›´æ–°æµç¨‹</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/reactCore/commit"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">commité˜¶æ®µ Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#æ¦‚è¿°" class="table-of-contents__link">æ¦‚è¿°</a></li><li><a href="#beginwork" class="table-of-contents__link"><code>beginWork</code></a><ul><li><a href="#æ„å»º-wip-æ ‘" class="table-of-contents__link">æ„å»º <code>wIP</code> æ ‘</a></li><li><a href="#å·¥ä½œå¾ªç¯" class="table-of-contents__link">å·¥ä½œå¾ªç¯</a></li><li><a href="#è§£æä¸åŒç±»å‹fiberç»“ç‚¹" class="table-of-contents__link">è§£æä¸åŒç±»å‹<code>Fiber</code>ç»“ç‚¹</a></li></ul></li><li><a href="#completework" class="table-of-contents__link"><code>completeWork</code></a><ul><li><a href="#domèŠ‚ç‚¹çš„åˆ›å»ºæ’å…¥" class="table-of-contents__link">DOMèŠ‚ç‚¹çš„åˆ›å»ºæ’å…¥</a></li><li><a href="#domå±æ€§çš„å¤„ç†" class="table-of-contents__link">DOMå±æ€§çš„å¤„ç†</a></li><li><a href="#effecttag-æ”¶é›†" class="table-of-contents__link"><code>effectTag</code> æ”¶é›†</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.7bae2b1a.js"></script>
<script src="/assets/js/main.df3858a9.js"></script>
</body>
</html>