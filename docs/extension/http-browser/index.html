<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.1">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="HonjayChang Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="HonjayChang Blog Atom Feed"><title data-react-helmet="true">HTTP-Browser | HonjayChang</title><meta data-react-helmet="true" property="og:url" content="https://honjaychang.github.io//docs/extension/http-browser"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="HTTP-Browser | HonjayChang"><meta data-react-helmet="true" name="description" content="HTTP状态码"><meta data-react-helmet="true" property="og:description" content="HTTP状态码"><link data-react-helmet="true" rel="shortcut icon" href="/img/photo.ico"><link data-react-helmet="true" rel="canonical" href="https://honjaychang.github.io//docs/extension/http-browser"><link data-react-helmet="true" rel="alternate" href="https://honjaychang.github.io//docs/extension/http-browser" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://honjaychang.github.io//docs/extension/http-browser" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.a08d23d3.css">
<link rel="preload" href="/assets/js/runtime~main.406cbef9.js" as="script">
<link rel="preload" href="/assets/js/main.53a30771.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP shadow--md">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/photo.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/photo.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Honjay</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/hc/html">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Honjaychang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/photo.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/photo.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Honjay</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/hc/html">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/Honjaychang" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">HC</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/hc/html">HTML</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/hc/css">CSS</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">JS</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/js/basic">JS 基础</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/js/advanced">JS 进阶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/js/dataStructure">JS 数据结构</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/js/module">模块化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/js/reg">正则</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Extension</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/extension/web-api">Web-API</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/extension/http-browser">HTTP-Browser</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">TS</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts/basic">basic</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">React</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/react/basic">React</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Dev</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/dev/git">GIT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/dev/node">Node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/dev/os">操作系统</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/dev/webpack">WebPack</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Network</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/network/basic">计网</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Algo</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/algo/basic">数据结构</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/algo/sort">排序</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/algo/sword">sword</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/algo/tree">树</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Interview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/interview/hand">各种手写</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/interview/scene">场景题</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Vue</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/vue/basic">basic</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">HTTP-Browser</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="http状态码"></a>HTTP<a href="HTTPs://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status" target="_blank" rel="noopener noreferrer">状态码</a><a class="hash-link" href="#http状态码" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="分类"></a>分类<a class="hash-link" href="#分类" title="Direct link to heading">#</a></h4><table><thead><tr><th align="left">分类</th><th align="left">分类描述</th></tr></thead><tbody><tr><td align="left">1**</td><td align="left">信息响应，服务器收到请求，需要请求者继续执行操作</td></tr><tr><td align="left">2**</td><td align="left">成功响应，操作被成功接收并处理</td></tr><tr><td align="left">3**</td><td align="left">重定向，需要进一步的操作以完成请求</td></tr><tr><td align="left">4**</td><td align="left">客户端错误，请求包含语法错误或无法完成请求</td></tr><tr><td align="left">5**</td><td align="left">服务器错误，服务器在处理请求的过程中发生了错误</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="常见状态码"></a>常见状态码<a class="hash-link" href="#常见状态码" title="Direct link to heading">#</a></h4><ul><li>200 - 请求成功</li><li>204 - 请求处理成功，但没有资源可返回</li><li>206 - 对资源的某一部分进行请求</li><li>301 - 资源被永久转移到其它 URL(永久重定向到新的 location)</li><li>302 - 资源临时移动(临时重定向)</li><li>304 - 所请求的资源未修改</li><li>307 - 临时重定向</li><li>400 - 请求报文存在语法错误</li><li>403 - 没有权限</li><li>404 - 请求的资源不存在</li><li>500 - 内部服务器错误</li><li>502 - 网关错误</li><li>504 - 网关超时</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="http-method"></a>HTTP Method<a class="hash-link" href="#http-method" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="传统的-methods"></a>传统的 methods<a class="hash-link" href="#传统的-methods" title="Direct link to heading">#</a></h4><ul><li><code>get</code> 获取服务器的数据</li><li><code>post</code> 向服务器提交数据</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="现在的-methods"></a>现在的 methods<a class="hash-link" href="#现在的-methods" title="Direct link to heading">#</a></h4><ul><li><code>get</code> 获取数据</li><li><code>post</code> 新建数据</li><li><code>patch/put</code> 更新数据</li><li><code>delete</code> 删除数据</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="restful-api"></a>Restful API<a class="hash-link" href="#restful-api" title="Direct link to heading">#</a></h4><ul><li><p>传统 API 设计:把每个 url 当做一个功能</p></li><li><p>Restful API 设计:一种新的 API 设计方法，把每个 url 当做一个唯一的资源</p></li><li><p>如何设计成一个资源？</p><ul><li>尽量不用 url 参数</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly basic"><pre tabindex="0" class="prism-code language-basic codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">传统API设计: /api/list?pageIndex=2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Restful API设计: /api/list/2</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>用 method 表示操作类型</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly basic"><pre tabindex="0" class="prism-code language-basic codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">传统API设计:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">post请求  /api/create-blog</span></span><span class="token-line" style="color:#393A34"><span class="token plain">post请求  /api/update-blog?id=100</span></span><span class="token-line" style="color:#393A34"><span class="token plain">get请求   /api/get-blog?id=100</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Restful API设计:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">post请求  /api/blog</span></span><span class="token-line" style="color:#393A34"><span class="token plain">patch请求  /api/blog/100</span></span><span class="token-line" style="color:#393A34"><span class="token plain">get请求   /api/blog/100</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="get-和-post-的区别？"></a>Get 和 Post 的区别？<a class="hash-link" href="#get-和-post-的区别？" title="Direct link to heading">#</a></h2><ul><li>缓存：<code>get</code>请求的数据是可以缓存的；<code>post</code>是不可缓存的。</li><li>功能<ul><li><code>get</code>请求类似于查找的过程，用户获取数据，可以不用每次都与数据库连接，所以可以使用缓存。</li><li><code>post</code>做的一般是修改和删除的工作，所以必须与数据库交互，所以不能使用缓存。</li></ul></li><li>传参：<code>get</code>传参，参数是在 url 中的；<code>post</code>传参，参数是在请求体中。</li><li>安全性：<code>get</code>不安全，<code>post</code>较为安全：<code>post</code>易于防止<code>CSRF</code>。</li><li>参数长度：<code>get</code>参数长度有限，是较小的；<code>post</code>传参长度不受限制。</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="get-请求传参长度的误区"></a>get 请求传参长度的误区<a class="hash-link" href="#get-请求传参长度的误区" title="Direct link to heading">#</a></h4><p><strong>误区</strong>：我们经常说 get 请求参数的大小存在限制，而 post 请求的参数大小是无限制的。</p><ul><li><p><code>HTTP</code>协议未规定<code>GET</code>和<code>POST</code>的请求长度限制</p></li><li><p><code>GET</code>的最大长度显示是因为：浏览器和 web 服务器限制了 URL 的长度</p></li><li><p>不同的浏览器和 WEB 服务器，限制的最大长度不一样</p></li><li><p>要支持<code>IE</code>，则最大长度为<code>2083byte</code>，若只支持<code>Chrome</code>，则最大长度 <code>8182byte</code></p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="http-首部"></a>HTTP 首部<a class="hash-link" href="#http-首部" title="Direct link to heading">#</a></h2><ul><li><p><code>HTTP</code> 请求报文：请求方法、<code>URI</code>、<code>HTTP</code>版本、<code>HTTP</code>首部字段</p></li><li><p><code>HTTP</code> 响应报文：<code>HTTP</code>版本、状态码、<code>HTTP</code>首部字段</p></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="http首部字段"></a><code>HTTP</code>首部字段<a class="hash-link" href="#http首部字段" title="Direct link to heading">#</a></h4><ul><li>首部字段名：字段值</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="通用首部字段"></a>通用首部字段<a class="hash-link" href="#通用首部字段" title="Direct link to heading">#</a></h4><ul><li><code>Cache-Control</code> ：能够控制缓存的行为</li><li><code>Connection</code><ul><li>控制不再转发给代理的首部字段</li><li>管理持久连接 <code>Connection: Keep-Alive / close</code> 一次 TCP 连接重复使用</li></ul></li><li><code>Date</code>：表明创建 HTTP 报文的日期和时间</li><li><code>Warning</code>：会告知用户一些与缓存相关的问题的警告</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="请求首部字段"></a>请求首部字段<a class="hash-link" href="#请求首部字段" title="Direct link to heading">#</a></h4><ul><li><code>Accept</code>：告知服务器，用户代理能够处理的媒体类型及媒体类型的相对优先级<ul><li><code>Accept-Charset </code>：优先的字符集</li><li><code>Accept-Encoding</code>：可接收的压缩算法 <code>gzip</code></li><li><code>Accept-Language</code>：<code>zh-cn</code></li></ul></li><li><code>Authorization</code>：Web 认证信息</li><li><code>Host</code>：请求的域名是什么</li><li><code>User-Agent</code>：浏览器信息</li><li><code>If-Match If-Modified-Since If-None-Match If-Range</code></li><li><code>Cookie</code></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="响应首部字段"></a>响应首部字段<a class="hash-link" href="#响应首部字段" title="Direct link to heading">#</a></h4><ul><li><code>ETag</code>：资源的匹配信息</li><li><code>Location</code>：提供重定向<code>url</code></li><li><code>Server</code>：HTTP 服务器的安装信息</li><li><code>Set-Cookie</code></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="实体首部字段"></a>实体首部字段<a class="hash-link" href="#实体首部字段" title="Direct link to heading">#</a></h4><ul><li><p>包含在请求报文和响应报文中的实体部分所使用的首部，用于补充内容的更新时间等与实体相关的信息</p></li><li><p><code>Content-Type: text/html</code></p></li><li><p><code>Keep-Alive: timeout=15, max=100 </code></p></li><li><p><code>Allow</code>：请求资源允许使用的方法</p></li><li><p><code>Content</code></p><ul><li><code>Content-Encoding</code>：返回数据的压缩算法，如 <code>gzip</code></li><li><code>Content-Language</code></li><li><code>Content-Length</code></li><li><code>Content-Type</code>：返回 / 发送数据的格式，如<code>application/json</code></li></ul></li><li><p><code>Expires Last-Modified</code></p></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="缓存相关"></a>缓存相关<a class="hash-link" href="#缓存相关" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Cache-Control   Expires</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Last-Modified If-Modified-Since</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Etag    If-None-Match</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="http-缓存策略"></a>HTTP 缓存策略<a class="hash-link" href="#http-缓存策略" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="浏览器的三级缓存"></a>浏览器的三级缓存<a class="hash-link" href="#浏览器的三级缓存" title="Direct link to heading">#</a></h4><ul><li>内存 =&gt; 磁盘 =&gt; 网络请求</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="强制缓存"></a>强制缓存<a class="hash-link" href="#强制缓存" title="Direct link to heading">#</a></h4><ul><li><p>在过期时间内，未被主动清除 都不会请求服务器 而使用强制缓存 =&gt; 协商缓存</p></li><li><p><code>200 from disk cache</code> <code>200 from memory cache</code></p></li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cache-control"></a><code>cache-control</code><a class="hash-link" href="#cache-control" title="Direct link to heading">#</a></h5><ul><li><code>max-age</code>：浏览器可以接收生存期不大于指定时间（秒）的响应</li><li><code>no-cache</code>：不用强制缓存，让服务端缓存</li><li><code>no-store</code>：不用强制缓存，也不让服务端缓存</li><li><code>private</code>：允许终端用户</li><li><code>public</code>：允许中间代理</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="expires"></a><code>Expires</code><a class="hash-link" href="#expires" title="Direct link to heading">#</a></h5><ul><li>同为控制缓存过期。如果 <code>cache-control</code> 与 <code>expires</code> 同时存在的话，<code>cache-control</code> 的优先级高于<code>expires</code></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="协商缓存（对比缓存）"></a>协商缓存（对比缓存）<a class="hash-link" href="#协商缓存（对比缓存）" title="Direct link to heading">#</a></h4><ul><li>浏览器和服务器协商，每次都需要和服务器通信</li><li>第一次请求时，服务器会返回资源和一个资源的缓存标识</li><li>第二次请求时，浏览器会先将缓存标识发给服务器 然后服务器对标识进行匹配<ul><li>不匹配 =&gt; 资源有更新 =&gt; 服务器返回新资源和新的缓存标识</li><li>匹配 =&gt; 资源未更改 =&gt; 返回 304 状态码 读取本地浏览器缓存</li></ul></li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="last-modified"></a><code>Last-Modified</code><a class="hash-link" href="#last-modified" title="Direct link to heading">#</a></h5><ul><li>对应 <code>If-Modified-Since</code></li><li>响应资源的最后修改时间 只能精确到秒级</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="etag"></a><code>Etag</code><a class="hash-link" href="#etag" title="Direct link to heading">#</a></h5><ul><li>对应 <code>If-None-Match</code></li><li><code>Etag</code>是服务器响应请求时，返回当前资源文件的一个唯一标识(类似指纹 由服务器生成)</li><li>同时存在 会优先使用 <code>Etag</code></li><li>如果资源被重复生成，而内容不变，则<code>Etag</code>更精确</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="浏览器加载js文件有缓存"></a>浏览器加载<code>JS</code>文件有缓存<a class="hash-link" href="#浏览器加载js文件有缓存" title="Direct link to heading">#</a></h5><ul><li>浏览器加载 js 文件是根据路径加载，首先根据路径在缓存里查找</li><li>解决办法：打包时加一些哈希值 or 版本号</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Ref</h5></div><div class="admonition-content"><ul><li><a href="https://blog.csdn.net/i13738612458/article/details/80383390?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&amp;dist_request_id=&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control" target="_blank" rel="noopener noreferrer">js 浏览器缓存机制</a></li><li><a href="https://blog.csdn.net/feiyu_may/article/details/88376945" target="_blank" rel="noopener noreferrer">浏览器缓存带来的前端项目更新问题及解决方法</a></li></ul></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="刷新操作对缓存的影响"></a>刷新操作对缓存的影响<a class="hash-link" href="#刷新操作对缓存的影响" title="Direct link to heading">#</a></h5><ul><li>正常操作:<ul><li>地址栏输入<code>url</code>，跳转链接，前进后退等</li><li>强制缓存有效，协商缓存有效</li></ul></li><li>手动刷新:<ul><li><code>F5</code>，点击刷新按钮，右击菜单刷新</li><li>强制缓存失效，协商缓存有效</li></ul></li><li>强制刷新:<ul><li><code>ctrl + F5</code></li><li>强制缓存失效，协商缓存失效</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="运行环境"></a>运行环境<a class="hash-link" href="#运行环境" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="网页加载过程"></a>网页加载过程<a class="hash-link" href="#网页加载过程" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="渲染过程"></a>渲染过程<a class="hash-link" href="#渲染过程" title="Direct link to heading">#</a></h5><ul><li>根据 <code>HTML</code> 代码生成 <code>DOM Tree</code></li><li>根据 <code>CSS</code> 代码生成 <code>CSSOM</code><ul><li><code>css</code> 不会阻塞<code>DOM</code>树的解析</li><li><code>css</code> 加载会阻塞<code>DOM</code>树渲染</li></ul></li><li>将 <code>DOM Tree</code> 和 <code>CSSOM</code> 整合形成 <code>Render Tree</code></li><li>根据 <code>Render Tree</code> 渲染页面</li><li>遇到 <code>&lt;script&gt;</code> 则暂停渲染，优先加载并执行<code>JS</code>代码，完成再继续</li><li>直至把 <code>Render Tree</code> 渲染完成</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="为什么要将-css-link-href-放在-head-中"></a>为什么要将 <code>CSS &lt;link href=&quot;#&quot;&gt;</code> 放在 head 中<a class="hash-link" href="#为什么要将-css-link-href-放在-head-中" title="Direct link to heading">#</a></h5><ul><li>在<code>DOM</code>树生成前就将<code>CSS</code>规则加载完</li><li>在<code>DOM</code>生成完成后直接和所有的<code>CSS</code>规则整合 =&gt; 一步渲染完成 <code>Render Tree</code></li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="为何建议将js放在body最后"></a>为何建议将<code>JS</code>放在<code>body</code>最后<a class="hash-link" href="#为何建议将js放在body最后" title="Direct link to heading">#</a></h5><ul><li>不放在最后的话，<code>JS</code> 代码会阻塞 <code>render tree</code> 的渲染，可能会导致页面渲染时间比较长</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Ref</h5></div><div class="admonition-content"><ul><li><a href="https://segmentfault.com/a/1190000018130499" target="_blank" rel="noopener noreferrer">css 加载会造成阻塞吗</a></li></ul></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="图片的加载不会阻塞-dom-渲染过程"></a>图片的加载不会阻塞 DOM 渲染过程<a class="hash-link" href="#图片的加载不会阻塞-dom-渲染过程" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">p</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">111</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">p</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">p</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">img src </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test.png&quot;</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">p</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//图片的加载不会阻塞DOM渲染过程</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">p</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">222</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">p</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="windowonload-和-domcontentloaded的区别"></a><code>window.onload</code> 和 <code>DOMContentLoaded</code>的区别<a class="hash-link" href="#windowonload-和-domcontentloaded的区别" title="Direct link to heading">#</a></h4><ul><li>建议使用<code>document.addEventListener(&#x27;DOMContentLoaded&#x27;, fn(){...})</code></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;load&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 页面的全部资源加载完成后才会执行，包括图片、视频等</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;DOMContentLoaded&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// DOM 渲染完成即可执行，此时图片、视频可能还没有加载完</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="什么是回流-什么是重绘？"></a>什么是回流 什么是重绘？<a class="hash-link" href="#什么是回流-什么是重绘？" title="Direct link to heading">#</a></h4><ul><li>回流<code>reflow</code>：<code>render</code>树中一部分或全部元素需要改变尺寸、布局、或着需要隐藏而需要重新构建</li><li>重绘<code>repaint</code>：<code>render</code>树中一部分元素改变，而不影响布局的，只影响外观的，比如颜色</li><li>回流必将引起重绘</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="优化方案"></a>优化方案<a class="hash-link" href="#优化方案" title="Direct link to heading">#</a></h5><ul><li>缓存 DOM 操作 多次 DOM 变成插入一个<code>createDocumentFragment</code></li><li>使用<code>window.requestAnimationFrame()</code>，因为它可以把代码推迟到下一次重绘之前执行，而不是立即要求页面重绘。</li><li>使用虚拟 DOM</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="raf"></a>RAF<a class="hash-link" href="#raf" title="Direct link to heading">#</a></h5><ul><li><p><strong><code>window.requestAnimationFrame()</code></strong> 告诉浏览器：你希望执行一个动画，并且要求浏览器在下次重绘之前调用指定的回调函数更新动画。</p></li><li><p>要想动画流畅，更新频率要 60 帧/s，即 16.67ms 更新一次视图</p></li><li><p><code>setTimeout</code> 要手动控制频率，而 RAF 浏览器会自动控制</p></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">后台标签或者隐藏在iframe中， </span><span class="token constant" style="color:#36acaa">RAF</span><span class="token plain"> 会暂停，而setTimeout 依然执行</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 3s 把宽度 从100px -&gt; 640px 增加 540px</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 60帧/s 3s 180帧 每次变化 3px</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 而且当页面切换的时候会暂停执行</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> div1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;div1&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> curWidth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> maxWidth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">640</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// setTimeout</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">animate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  curWidth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> curWidth </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  div1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">width</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> curWidth </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;px&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">curWidth</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> div1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">width</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">curWidth </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> maxWidth</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">animate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16.7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 这里的animate 没加括号</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// RAF</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">animate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  curWidth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> curWidth </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  div1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">width</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> curWidth </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;px&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">curWidth</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> div1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">width</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">curWidth </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> maxWidth</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">requestAnimationFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">animate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 时间不用自己控制</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">animate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="js-脚本的异步加载"></a>JS 脚本的异步加载<a class="hash-link" href="#js-脚本的异步加载" title="Direct link to heading">#</a></h4><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Ref</h5></div><div class="admonition-content"><ul><li><a href="https://wangdoc.com/javascript/bom/engine.html" target="_blank" rel="noopener noreferrer">浏览器环境概述</a></li></ul></div></div><p>如何使<code>JS</code>文件在顶部仍然稍后加载呢？</p><p>常应用在引用了广告和统计的页面中，不会影响、堵塞，更不会影响到到页面其他元素</p><ul><li><p>使用<code>defer</code></p><ul><li><code>&lt;script src=&quot;a.js&quot; defer&gt;&lt;/script&gt;</code></li><li><code>defer</code>的作用是延迟脚本的执行，等到 DOM 加载生成后，再执行脚本</li><li>浏览器发现带有<code>defer</code>属性的<code>script</code>会继续往下解析 HTML 网页，同时并行下载<code>script</code>的外部脚本，等待网页解析完成再去执行脚本</li></ul></li><li><p>使用<code>async</code></p><ul><li><code>&lt;script src=&quot;a.js&quot; async&gt;&lt;/script&gt;</code></li><li><code>async</code>的作用是使用另一个进程下载脚本，下载时不会阻塞渲染</li><li>浏览器发现带有<code>async</code>属性的<code>script</code>会继续往下解析 HTML 网页，同时并行下载<code>script</code>的外部脚本。当脚本下载完成会暂停 HTML 解析，先去执行脚本，执行完再来解析 HTML。 这与<code>defer</code>有点差异</li><li><code>async</code>会无视脚本顺序，优先执行先下载完成的</li><li>当同时存在<code>defer async</code>的时候 <code>defer</code>将会失效</li></ul></li><li><p>动态插入 <code>script</code> 标签</p><ul><li>动态生成的<code>script</code>标签不会阻塞页面渲染，但无法保证脚本的执行顺序</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;a.js&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;b.js&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">src</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> script </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;script&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">head</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">appendChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>通过 <code>ajax</code> 去获取 js 代码，然后通过 eval 执行</li><li>创建并插入 <code>iframe</code>，让它异步执行 js</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Ref</h5></div><div class="admonition-content"><ul><li><a href="https://juejin.cn/post/6844903661139656718" target="_blank" rel="noopener noreferrer"><code>JS脚本异步加载浅析</code></a></li></ul></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="性能优化"></a>性能优化<a class="hash-link" href="#性能优化" title="Direct link to heading">#</a></h2><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Ref</h5></div><div class="admonition-content"><ul><li><a href="https://juejin.cn/post/6844904031240863758" target="_blank" rel="noopener noreferrer">2020 年了,再不会 webpack 敲得代码就不香了(近万字实战)</a></li><li><a href="https://juejin.cn/post/6854573213171580941" target="_blank" rel="noopener noreferrer">你可能不知道的 9 条 Webpack 优化策略</a></li></ul></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="性能优化原则"></a>性能优化原则<a class="hash-link" href="#性能优化原则" title="Direct link to heading">#</a></h4><ul><li>多使用内存、缓存或其他方法</li><li>减少 CPU 计算量，减少网络请求，减少网络加载耗时</li><li>空间换时间</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="从何入手"></a>从何入手<a class="hash-link" href="#从何入手" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="让加载更快"></a>让加载更快<a class="hash-link" href="#让加载更快" title="Direct link to heading">#</a></h5><ul><li>减少资源体积：压缩代码</li><li>减少访问次数：合并代码，SSR 服务器端渲染，缓存</li><li>使用更快的网络： CDN</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="让渲染更快"></a>让渲染更快<a class="hash-link" href="#让渲染更快" title="Direct link to heading">#</a></h5><ul><li><code>CSS</code> 放在<code>head</code> ，<code>JS</code>放在<code>body</code>最下面</li><li>尽早开始执行<code>JS</code>，用<code>DOMContentLoaded</code></li><li>触发懒加载（图片懒加载，上滑加载更多）</li><li>对 DOM 查询进行缓存</li><li>频繁 DOM 操作，合并到一起插入 DOM 结构</li><li>节流<code>throttle</code>防抖<code>debounce</code></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="实例"></a>实例<a class="hash-link" href="#实例" title="Direct link to heading">#</a></h4><ul><li><p>资源合并 ==&gt; 请求三次 3kb 和请求一次 9kb 3 次网络请求--&gt; 1 次</p></li><li><p>缓存 ==&gt; webpack 生成的<code>bundle.[contenthash].js </code></p><ul><li>如果生成的内容没有发生变化即哈希值没有发生改变 则不需要重新进行请求</li><li>静态资源加<code>hash</code>后缀，根据文件内容计算<code>hash</code>。如果文件内容不变，则<code>hash</code>不变，则<code>url</code>不变。既然 url 和文件不变，则会自动触发 HTTP 缓存机制，返回 304</li></ul></li><li><p><code>CDN</code> ==&gt; 根据地域做网络服务。静态文件 满足 304 机制</p></li><li><p><code>SSR</code> ==&gt; 服务器端渲染：网页和数据一起加载，一起渲染</p></li><li><p>非 <code>SSR</code> ==&gt; （前后端分离）：先加载网页，再加载数据，再渲染数据 (早先的<code>JSP ASP PHP</code> ，现在的<code>vue React </code></p></li><li><p>懒加载</p><ul><li>加载<code>loading</code>图片</li><li>判断哪些图片要加载</li><li>隐形加载图片</li><li>替换真图片</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 一张图片就是一个`&lt;img&gt;`标签，浏览器是否发起请求图片是根据`&lt;img&gt;`的`src`属性，所以实现懒加载的关键就是，在图片没有进入可视区域时，先不给`&lt;img&gt;`的`src`赋值，这样浏览器就不会发送请求了，等到图片进入可视区域再给`src`赋值</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 可以给img标签统-自定义属性data=src=&#x27;default.png&#x27;，当检测到图片出现在窗口之后再补充src属性，此时才会进行图片资源加载</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">lazyload</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> imgs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementsByTagName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;img&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> len </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imgs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 视口高度</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> viewHeight </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">documentElement</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">clientHeight</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//滚动务高度</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> scrollHeight </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">documentElement</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">scrolltop</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">scrollTop</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> len</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> offsetHeight </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imgs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">offsetTop</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">offsetHeight </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> viewHeight </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> scrollHeight</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> src </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imgs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      imgs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//可以使用节流优化一下</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventlListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;scroll&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lazyload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Ref</h5></div><div class="admonition-content"><ul><li><a href="https://blog.csdn.net/w1418899532/article/details/90515969" target="_blank" rel="noopener noreferrer">js 实现图片懒加载原理</a></li></ul></div></div><ul><li>缓存 DOM 查询</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 不缓存 DOM 查询结果</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementsByTagName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;p&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 每次循环 都会计算length 频繁进行DOM查询</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 缓存 DOM 查询结果</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> pList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementsByTagName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;p&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> length </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 缓存length 只进行一次 DOM 查询</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>多个 DOM 操作一起插入到 DOM 结构：<ul><li><code>document.createDocumentFragment()</code></li></ul></li><li>尽早开始<code>JS</code>执行</li><li><code>document.addEventListener(&#x27;DOMContentLoaded&#x27;, function () {}</code></li><li>防抖节流</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="首屏优化"></a>首屏优化<a class="hash-link" href="#首屏优化" title="Direct link to heading">#</a></h5><ul><li>尽可能的缩小 webpack 或者其他打包工具生成的包的大小</li><li>路由懒加载</li><li>组件按需加载</li><li>图片懒加载</li><li>服务端渲染 SSR</li><li>gzip</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="csr-ssr"></a>CSR SSR<a class="hash-link" href="#csr-ssr" title="Direct link to heading">#</a></h5><ul><li><code>CSR</code> 客户端渲染</li><li><code>SSR</code> 服务端渲染<ul><li>由服务端把渲染的完整的页面返回给客户端，减少了一次客户端到服务端的一次 http 请求</li><li>返回完整页面 就利于 SEO 优化</li><li>SSR 强在首屏渲染。而 CSR 强在用户和页面多交互的场景</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="安全"></a>安全<a class="hash-link" href="#安全" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="xss-跨站脚本攻击"></a><code>XSS</code> 跨站脚本攻击<a class="hash-link" href="#xss-跨站脚本攻击" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="攻击"></a>攻击<a class="hash-link" href="#攻击" title="Direct link to heading">#</a></h5><blockquote><p>反射型<code>XSS</code></p></blockquote><ul><li>反射型<code>XSS</code>，非持久化，需要欺骗用户自己去点击链接才能触发<code>XSS</code>代码（服务器中没有这样的页面和内容），一般容易出现在搜索页面。</li></ul><blockquote><p>存储型<code>XSS</code></p></blockquote><p>一个博客网站，我发表一篇博客，其中嵌入<code>&lt;script&gt;</code>脚本，脚本内容：获取<code>cookie</code>，发送到我的服务器（服务器配合跨域）。发布这篇博客，有人查看它，我轻松收割访问者的<code>cookie</code>。</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="预防"></a>预防<a class="hash-link" href="#预防" title="Direct link to heading">#</a></h5><blockquote><p>转译字符</p></blockquote><ul><li>前端要替换，后端也要替换，都做总不会有错</li><li><code>https://www.npmjs.com/package/xss</code></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">escape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">&amp;</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;amp;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">&lt;</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;lt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">&gt;</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">&quot;</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;quto;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">&#x27;</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;#39;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">`</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;#96;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">\/</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;#x2F;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p><code>HttpOnly</code></p></blockquote><ul><li>禁止通过<code>document.cookie</code>的方式获取<code>cookies</code></li></ul><blockquote><p>设置白名单或者黑名单</p></blockquote><ul><li>对于富文本编辑器 建议使用 白名单</li></ul><blockquote><p><code>csp</code></p></blockquote><ul><li><code>Content Security Policy</code> 内容安全策略</li><li>实质：白名单制度，开发者明确告诉客户端，哪些外部资源可以加载和执行</li></ul><p>如何启用<code>CSP</code></p><ul><li>通过 HTTP 头信息的<code>Content-Security-Policy</code>的字段</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">Content</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Security</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Policy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> script</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">src </span><span class="token string" style="color:#e3116c">&#x27;self&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> object</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">src </span><span class="token string" style="color:#e3116c">&#x27;none&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">style</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">src cdn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">example</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">org</span><span class="token plain"> third</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">party</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">org</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> child</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">src https</span><span class="token operator" style="color:#393A34">:</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>通过网页的<code>&lt;meta&gt;</code>标签</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">meta http</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">equiv</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Content-Security-Policy&quot;</span><span class="token plain"> content</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;script-src &#x27;self&#x27;; object-src &#x27;none&#x27;; style-src cdn.example.org third-party.org; child-src https:&quot;</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>如上设置<ul><li>脚本：只信任当前域名</li><li><code>&lt;object&gt;</code>标签：不信任任何 URL，即不加载任何资源</li><li>样式表：只信任<code>cdn.example.org</code>和<code>third-party.org</code></li><li>框架 <code>(frame)</code>：必须使用<code>HTTPS</code>协议加载</li><li>其他资源：没有限制</li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="csrf-跨站请求伪造"></a><code>CSRF</code> 跨站请求伪造<a class="hash-link" href="#csrf-跨站请求伪造" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="攻击-1"></a>攻击<a class="hash-link" href="#攻击-1" title="Direct link to heading">#</a></h5><p>原理： 诱导用户打开黑客的网站，在黑客的网站中，利用用户登录状态发起跨站点请求。</p><ol><li>浏览器向网站 A 发起通信请求</li><li>网站 A 验证通过，建立了通信连接，在浏览器存了 A 的 cookie</li><li>浏览器在未关闭 A 的连接下访问网站 B</li><li>网站 B 含有恶意请求代码，向网站 A 发起请求</li><li>浏览器根据 B 发起的请求并且携带 A 的 cookie 访问 A</li><li>网站 A 验证 cookie 并且响应了这个请求</li></ol><p>网站 B 就通过盗用保存在客户端的 cookie，以客户端的身份来访问网站 A，以客户端身份进行一些非法操作。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">你正在购物，看中了某个商品，商品id是</span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">付费接口是xxx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">pay</span><span class="token operator" style="color:#393A34">?</span><span class="token plain">id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token plain">，但没有任何验证</span></span><span class="token-line" style="color:#393A34"><span class="token plain">我是攻击者，我看中了一个商品，id是</span><span class="token number" style="color:#36acaa">200</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">我向你发送一封电子邮件，邮件标题很吸引人</span></span><span class="token-line" style="color:#393A34"><span class="token plain">但邮件正文隐藏着</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">img src</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">xxx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">pay</span><span class="token operator" style="color:#393A34">?</span><span class="token plain">id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">200</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">你一查看邮件，就帮我购买了id是</span><span class="token number" style="color:#36acaa">200</span><span class="token plain">的商品</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="预防-1"></a>预防<a class="hash-link" href="#预防-1" title="Direct link to heading">#</a></h5><blockquote><p><code>SameSite</code></p></blockquote><ul><li><p>对 <code>Cookie</code> 设置 <code>SameSite</code> 属性。表示 <code>Cookie</code> 不随着跨域请求发送，可以很大程度减少 <code>CSRF</code> 的攻击，但是存在兼容性问题。</p><ul><li><p><code>Strict</code>：所有从当前域发送出来的非同域请求都不会带上<code>cookie</code></p></li><li><p><code>Lax</code>：就是在 GET 方式提交表单时会携带<code>cookie，post、iframe/img</code>等标签加载时不会携带<code>cookie</code>。</p></li><li><p><code>None</code>：关闭<code>SameSite</code>，不过，前提是必须同时设置<code>Secure</code>属性<code>(Cookie 只能通过 HTTPS 协议发送)</code>，否则无效。</p></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token known-class-name class-name">Set</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Cookie</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">CookieName</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">CookieValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token maybe-class-name">SameSite</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">Strict</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//这个规则过于严格，可能造成非常不好的用户体验。</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//比如，当前网页有一个 GitHub 链接，用户点击跳转就不会带有 GitHub 的 Cookie，跳转过去总是未登陆状态。</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token known-class-name class-name">Set</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Cookie</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">CookieName</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">CookieValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token maybe-class-name">SameSite</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">Lax</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//Lax规则稍稍放宽，大多数情况也是不发送第三方 Cookie，但是导航到目标网址的 Get 请求除外。</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token known-class-name class-name">Set</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Cookie</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> widget_session</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">abc123</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token maybe-class-name">SameSite</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">None</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token maybe-class-name">Secure</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>验证 <code>HTTP Referer</code> 字段</p></blockquote><ul><li><code>HTTP Referer</code>是<code>header</code>的一部分，当浏览器向 web 服务器发送请求时，一般会带上<code>Referer</code>信息告诉服务器是从哪个页面链接过来的，服务器籍此可以获得一些信息用于处理。可以通过检查请求的来源来防御<code>CSRF</code>攻击。正常请求的<code>referer</code>具有一定规律，如在提交表单的<code>referer</code>必定是在该页面发起的请求。所以通过检查<code>http</code>包头<code>referer</code>的值是不是这个页面，来判断是不是<code>CSRF</code>攻击。</li><li><code>Refer</code> 可能被伪造</li></ul><blockquote><p>在请求地址中添加 <code>token</code> 并验证</p></blockquote><ul><li><p><code>token</code> 请求拦截 验证是否合法</p></li><li><p>使用 <code>post</code> 接口</p></li><li><p>增加验证，例如密码、短信验证码、指纹等</p></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sql-注入"></a><code>sql</code> 注入<a class="hash-link" href="#sql-注入" title="Direct link to heading">#</a></h4><blockquote><p>权限最小化</p></blockquote><ul><li>严格限制 Web 应用的数据库的操作权限，给此用户提供仅仅能够满足其工作的最低权限，从而最大限度的减少注入攻击对数据库的危害。</li></ul><blockquote><p>正则匹配 字符转义</p></blockquote><ul><li><code>const reg = /select|update|delete|exec|count|&#x27;|&quot;|=|;|&gt;|&lt;|%/i;</code></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="点击劫持"></a>点击劫持<a class="hash-link" href="#点击劫持" title="Direct link to heading">#</a></h4><ul><li>通过覆盖不可见的框架误导受害者点击<ul><li>使用一个透明的<code>iframe</code>，覆盖在一个网页上，诱使用户在该页面上进行操作</li><li>使用一张图片覆盖在网页，遮挡网页原有位置的含义</li></ul></li></ul><p>使用 HTTP 头 <code>X-Frame-Options</code> 进行攻击防御这个</p><ul><li><code>deny</code>：表示该页面不允许在 <code>frame</code> 中展示，即便是在相同域名的页面中嵌套也不允许</li><li><code>sameorigin</code>：表示该页面可以在相同域名页面的 <code>frame</code> 中展示</li><li><code>allow-form url</code>：表示该页面可以在指定来源的 <code>frame</code> 中展示</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Ref</h5></div><div class="admonition-content"><ul><li><a href="https://zhuanlan.zhihu.com/p/83865185" target="_blank" rel="noopener noreferrer">前端安全</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/09/csp.html" target="_blank" rel="noopener noreferrer">Content Security Policy 入门教程</a></li><li><a href="https://juejin.cn/post/6951571103953190925" target="_blank" rel="noopener noreferrer">一、web 安全（xss/csrf）简单攻击原理和防御方案（理论篇）</a></li></ul></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/extension/web-api"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Web-API</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/ts/basic"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">basic »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#http状态码" class="table-of-contents__link">HTTP状态码</a></li><li><a href="#http-method" class="table-of-contents__link">HTTP Method</a></li><li><a href="#get-和-post-的区别？" class="table-of-contents__link">Get 和 Post 的区别？</a></li><li><a href="#http-首部" class="table-of-contents__link">HTTP 首部</a></li><li><a href="#http-缓存策略" class="table-of-contents__link">HTTP 缓存策略</a></li><li><a href="#运行环境" class="table-of-contents__link">运行环境</a></li><li><a href="#性能优化" class="table-of-contents__link">性能优化</a></li><li><a href="#安全" class="table-of-contents__link">安全</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Honjaychang</div></div></div></footer></div>
<script src="/assets/js/runtime~main.406cbef9.js"></script>
<script src="/assets/js/main.53a30771.js"></script>
</body>
</html>